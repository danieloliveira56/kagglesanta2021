import pandas as pd
import time
import subprocess
import csv
import numpy as np
import math
from helpers import SPECIAL_CHARS, get_words_in_string, export_string_map, offset, is_perm,\
    get_tsp_solution, get_words, map_solution, check_word_count, get_superwords, get_unique_words_in_string, \
    get_wild_super_words, word_is_contained, get_5913_sol, cost

import random

from optimization import get_optimal_solution
from optimization_specials import maximize_specials
from clustering import get_word_clusters
from atsp import solve_atsp
from LKH import get_acvrp_solution
import itertools
from wildcard_postprocessing import rebalance_perms, improve_submission_with_wildcards

##CONFIGURATIOMNS
relax = False
single_string = True
num_letters = 7
num_strings = 120
num_wildcards = 2
partition_idx = 1


# (num of words, per num of positions)
DENSITY = {
    4: (2, 4),
    5: (3, 4),
    6: (4, 6),
    7: (5, 7),
}
REAL_NUM_PARTITIONS = 3

# print(cost("1725364", "*253647"))
# print(cost("*253647", "1725364"))
# exit()

def partition_and_solve(num_letters, num_partitions=3, partition_idx=0, num_wildcards=2, disperse_specials=False,
                        concentrate_specials=True):
    '''

    :param num_letters:
    :param num_partitions:
    :param partition_idx:
    :param num_wildcards:
    :param disperse_specials:
    :param concentrate_specials:

    If both are disperse_specials and concentrate_specials are False, we exclude the specials from the word list.
    :return:
    '''

    words = get_words(num_letters)

    (special1, special2) = SPECIAL_CHARS[7]
    free_words = [w for w in words if int(w[0]) != special1 or int(w[1]) != special2]
    special_words = [w for w in words if int(w[0]) == special1 and int(w[1]) == special2]

    print(f"Originally have {len(words)} words: {len(free_words)} free_words and {len(special_words)} special_words")

    word_partitions = []
    start = end = 0
    remaining_words = len(free_words)
    while end < len(free_words):
        n = math.ceil(remaining_words / (num_partitions - len(word_partitions)))
        end += n
        remaining_words -= n
        word_partitions.append(free_words[start:end])
        start = end

    if disperse_specials:
        num_special_words_partitions = num_partitions // REAL_NUM_PARTITIONS

        special_word_partitions = []
        start = end = 0
        remaining_words = len(special_words)
        while end < len(special_words):
            n = remaining_words // (num_special_words_partitions - len(special_word_partitions))
            end += n
            remaining_words -= n
            special_word_partitions.append(special_words[start:end])
            start = end
        print(f"Partition sizes: {[len(p) for p in word_partitions]}")
        print(sum([len(p) for p in word_partitions]))
        print(special_word_partitions)
        for i in range(REAL_NUM_PARTITIONS):
            print(len(word_partitions[num_special_words_partitions * i:num_special_words_partitions * (i+1)]))
            print(num_special_words_partitions * i, num_special_words_partitions * (i+1))
            for j, p in enumerate(word_partitions[num_special_words_partitions * i:num_special_words_partitions * (i+1)]):
                for w in special_word_partitions[j]:
                    p.append(w)
    elif concentrate_specials:
        for w in special_words:
            word_partitions[partition_idx].append(w)

    print(f"Partition sizes: {[len(p) for p in word_partitions]}")
    print(sum([len(p) for p in word_partitions]))

    print(f"Optimizing partition {partition_idx} with {len(word_partitions[partition_idx])} words")
    words = word_partitions[partition_idx]

    opt_solution = get_optimal_solution(words,
                                        num_strings=1,
                                        num_letters=7,
                                        word_density=DENSITY[num_letters],
                                        num_wildcards=num_wildcards,
                                        )

    return opt_solution


def split_and_search(num_letters=7):
    words = get_words(num_letters)

    (special1, special2) = SPECIAL_CHARS[7]
    free_words = [w for w in words if int(w[0]) != special1 or int(w[1]) != special2]
    special_words = [w for w in words if int(w[0]) == special1 and int(w[1]) == special2]

    adjust1 = 18
    adjust2 = 12

    group1 = free_words[:1640-adjust1] + special_words
    group2 = free_words[1640-adjust1:3280+adjust2] + special_words
    group3 = free_words[3280+adjust2:] + special_words

    print("Finding initial TSP solutions...")
    string1 = get_tsp_solution(group1)
    string2 = get_tsp_solution(group2)
    string3 = get_tsp_solution(group3)

    print("Improving string 1...")
    better_string1 = local_search(num_letters=num_letters, search_length=30, initial_solution=string1)
    print("Improving string 2...")
    better_string2 = local_search(num_letters=num_letters, search_length=30, initial_solution=string2)
    print("Improving string 3...")
    better_string3 = local_search(num_letters=num_letters, search_length=30, initial_solution=string3)

    for k, v in REPLACE_DICT.items():
        better_string1 = better_string1.replace(k, v)
        better_string2 = better_string2.replace(k, v)
        better_string3 = better_string3.replace(k, v)

    sub = pd.DataFrame()
    sub['schedule'] = [string1, string2, string3]
    sub.to_csv('submission.csv', index=False)
    sub.head()


def local_search(num_letters=7, search_length=30, initial_solution=None, other_strings=None, assume_shortening=0):

    other_strings_words = set()
    for s in other_strings:
        for w in get_words_in_string(num_letters, s):
            other_strings_words.add(w)

    if not initial_solution:
        print("Getting initial solution...")
        words = get_words(num_letters)
        initial_solution = get_tsp_solution(words)
        initial_solution = list(initial_solution)
        initial_solution[num_letters] = "*"
        initial_solution[2*num_letters] = "*"
        initial_solution = "".join(initial_solution)

    words = get_words_in_string(num_letters, initial_solution)
    special_words = [w for w in words if int(w[0]) == 5 and int(w[1]) == 4]

    essential_words = [w for w in words if w not in other_strings_words] + special_words
    print(f"Words in string: {len(words)}")
    current_solution = initial_solution

    print("Mapping words to positions and vice-versa...")
    # Positions where each w can be found
    word_map, position_map = map_solution(words, current_solution)

    i = 0

    log_search = True

    while i < len(current_solution)-num_letters and i <= len(current_solution)-search_length:
        if log_search:
            print(f"\nChecking position {i} to {i+search_length-1}: {current_solution[i:i+search_length]}")
            print("Word List:")
        search_words = set()
        other_words = set()

        if log_search:
            for j in range(i-num_letters, i):
                if j >= 0:
                    print(j, position_map[j], *[word_map[position_map[j]], position_map[j] in essential_words] if position_map[j] else "")
            print("----")
        for j in range(len(current_solution) - num_letters+1):
            if j in range(i, i+search_length-num_letters+1):
                if position_map[j]:
                    search_words.add(position_map[j])
                if log_search:
                    print(j, position_map[j], *[word_map[position_map[j]], position_map[j] in essential_words] if position_map[j] else "")
            else:
                if position_map[j]:
                    other_words.add(position_map[j])
        if log_search:
            print("----")
            for j in range(i+search_length-num_letters+1, i+search_length):
                if j < len(current_solution):
                    print(j, position_map[j], *[word_map[position_map[j]], position_map[j] in essential_words] if position_map[j] else "")

        num_wildcards = 0
        for j in range(i, i + search_length):
            if current_solution[j] == '*':
                num_wildcards += 1

        # Words that must continue existing in the substring
        unique_search_words = [w for w in search_words
                               if (w in special_words and w not in other_words)
                               or (w not in special_words and w not in other_words and w not in other_strings_words)]
        print(f"Substring has {len(search_words)} words, of which {len(search_words)-len(unique_search_words)} can be found somewhere else.", )

        if i == 0:
            fix_suffix = 0
        else:
            fix_suffix = num_letters - 1
        j = i - 1
        while j > 0 and not position_map[j] and fix_suffix > 0:
            fix_suffix -= 1
            j -= 1

        loose_following = 0
        j = i + search_length - num_letters + 1
        while (not position_map.get(j) or len(word_map[position_map[j]]) > 1 or position_map[j] not in essential_words) and loose_following < num_letters:
            loose_following += 1
            j += 1

        print(f"Loose_following: {loose_following}")
        print(f"Fix_suffix: {fix_suffix}")

        if unique_search_words and (loose_following >= num_letters - 1): #  or fix_suffix < num_letters / 2
            print("Optimizing substring...")
            optimal_order = get_optimal_solution(
                list(unique_search_words),
                initial_solution=[current_solution[i:i+search_length]],
                num_strings=1,
                num_wildcards=num_wildcards,
                save_model=False,
                UB=search_length,
                LB=max(num_letters, num_letters+len(unique_search_words)-1-num_letters*num_wildcards),
                fix_suffix=fix_suffix,
                assume_shortening=assume_shortening,
            )
            # optimal_order = get_tsp_solution(unique_search_words, start=current_solution[i-fix_suffix:i],
            #                                  end=current_solution[i-fix_suffix:i])
            #optimal_order = current_solution[i:i+search_length]
            #solve_atsp(list(unique_search_words))
            print(len(optimal_order), optimal_order)
            if len(optimal_order) < search_length:
                print(f"Shortening the initial solution by {search_length - len(optimal_order)} letters...")

                print(current_solution)
                new_solution = current_solution[:i] + optimal_order + current_solution[i+search_length:]
                print(new_solution)
                new_words = get_words_in_string(num_letters, new_solution)

                if any(w not in new_words for w in essential_words):
                    print("\n\nERROR: Words disappeared ###############################")
                    for w in essential_words:
                        if w not in new_words:
                            print(w)
                            print("essential_words", essential_words)
                    print()
                elif len(new_solution) < len(current_solution):
                    print("Found Improved Solution ####################################")
                    current_solution = new_solution
                    print("Remapping words...")
                    word_map, position_map = map_solution(words, current_solution)
                    # Reset loop
                    i = -1
        i += 1
    return current_solution


def improve_with_atsp(strings):

    words7 = get_words(7)
    special_words = [w for w in words7 if w[:2] == '12']
    special_wild_words = [w.replace('1', '*') for w in special_words]
    # special_wild_words += [w.replace('2', '*') for w in special_words]
    # special_wild_words += [w.replace('3', '*') for w in special_words]
    # special_wild_words += [w.replace('4', '*') for w in special_words]
    # special_wild_words += [w.replace('5', '*') for w in special_words]
    # special_wild_words += [w.replace('6', '*') for w in special_words]
    # special_wild_words += [w.replace('7', '*') for w in special_words]

    sequence = list(itertools.permutations(list(range(len(strings)))))

    has_improvement = True
    s = 0
    while has_improvement or s < len(sequence):
        if s >= len(sequence):
            has_improvement = False
            s = 0

        words = [
            get_unique_words_in_string(string)
            for string in strings
        ]

        seen = set()
        for i in sequence[s]:
            words[i] = [w for w in words[i] if w[:2] == '12' or w not in seen]
            for w in words[i]:
                seen.add(w)

        free_words = [
            [w for w in words_i if w not in special_words]
            for words_i in words
        ]

        super_words = [
            get_superwords(words_i)
            for words_i in words
        ]

        # for i, (string_i, words_i, super_words_i) in enumerate(zip(strings, words, super_words)):
        #     print(f"String {i+1}: length {len(string_i)}, {len(words_i)} words, {len(super_words_i)} superwords")

        for i in sequence[s]:
            free_wild_words = [w.replace('1', '*') for w in free_words[i] if '12' in w]
            # free_wild_words += [w.replace('2', '*') for w in free_words[i]]
            # free_wild_words += [w.replace('3', '*') for w in free_words[i]]
            # free_wild_words += [w.replace('4', '*') for w in free_words[i]]
            # free_wild_words += [w.replace('5', '*') for w in free_words[i]]
            # free_wild_words += [w.replace('6', '*') for w in free_words[i]]
            # free_wild_words += [w.replace('7', '*') for w in free_words[i]]

            super_wild_words = [w.replace('12', '*2', 1) for w in super_words[i]]


            # +special_wild_words+free_wild_words
            # special_words+special_wild_words+free_wild_words+free_words[i]
            result = solve_atsp([special_words],
                                free_words[i],
                                super_wild_words + super_words[i],
                                num_strings=1,
                                UB=2431,
                                save_model=True)

            if result and len(result[0]) < len(strings[i]):
                strings[i] = result[0]
                has_improvement = True

        s += 1

    return strings


def improve_pairs_with_atsp(strings):

    words7 = get_words(7)
    special_words = [w for w in words7 if w[:2] == '12']
    special_wild_words = [w.replace('1', '*') for w in special_words]
    # special_wild_words += [w.replace('2', '*') for w in special_words]
    # special_wild_words += [w.replace('3', '*') for w in special_words]
    # special_wild_words += [w.replace('4', '*') for w in special_words]
    # special_wild_words += [w.replace('5', '*') for w in special_words]
    # special_wild_words += [w.replace('6', '*') for w in special_words]
    # special_wild_words += [w.replace('7', '*') for w in special_words]

    sequence = list(itertools.permutations(list(range(len(strings)))))

    has_improvement = True
    s = 2
    while has_improvement or s < len(sequence):
        if s >= len(sequence):
            has_improvement = False
            s = 0

        words = [
            get_unique_words_in_string(string)
            for string in strings
        ]

        seen = set()
        for i in sequence[s]:
            words[i] = [w for w in words[i] if w[:2] == '12' or w not in seen]
            for w in words[i]:
                seen.add(w)

        free_words = [
            [w for w in words_i if w not in special_words]
            for words_i in words
        ]

        super_words = [
            get_superwords(words_i)
            for words_i in words
        ]

        for i, (string_i, words_i, super_words_i) in enumerate(zip(strings, words, super_words)):
            print(f"String {i+1}: length {len(string_i)}, {len(words_i)} words, {len(super_words_i)} superwords")

        i = sequence[s][0]
        j = sequence[s][1]
        free_wild_words = [w.replace('1', '*') for w in free_words[0]]
        free_wild_words += [w.replace('1', '*') for w in free_words[1]]

        super_wild_words = [w.replace('12', '*2', 1) for w in super_words[i]]
        super_wild_words += [w.replace('12', '*2', 1) for w in super_words[j]]

        # special_words + special_wild_words + free_words[i] + free_words[j]
        result = solve_atsp([special_words, special_words],
                            free_words[i]+free_words[j],
                            super_words[i]+super_words[j]+super_wild_words,
                            num_strings=2,
                            UB=2429,
                            )

        if result and len(result[0]) < len(strings[i]) and len(result[1]) < len(strings[j]):
            strings[i] = result[0]
            strings[i] = result[1]
            has_improvement = True

        s += 1

    return strings


def optimize_triple_with_superwords_atsp(strings):

    words7 = get_words(7)
    special_words = [w for w in words7 if w[:2] == '12']

    words = [
        get_unique_words_in_string(string)
        for string in strings
    ]

    seen = set()
    for i in range(len(strings)):
        words[i] = [w for w in words[i] if w[:2] == '12' or w not in seen]
        for w in words[i]:
            seen.add(w)

    free_words = [
        [w for w in words_i if w not in special_words]
        for words_i in words
    ]

    super_words = [
        get_superwords(words_i)
        for words_i in words
    ]

    super_wild_words = []
    for w in sum(super_words, []):
        wi = w
        while wi.find('12') > -1:
            super_wild_words.append(wi.replace('12', '*2', 1).replace('xx', '12'))
            wi = wi.replace('12', 'xx', 1)

    for i, (string_i, words_i, super_words_i) in enumerate(zip(strings, words, super_words)):
        print(f"String {i+1}: length {len(string_i)}, {len(words_i)} words, {len(super_words_i)} superwords")

    result = solve_atsp([special_words, special_words, special_words],
                        sum(free_words, []),
                        sum(super_words, [])+super_wild_words,
                        num_strings=3,
                        min_max_obj=True,
                        mtz_model=True,
                        )

    if result:
        for i, res in enumerate(result):
            strings[i] = res

    return strings


superperm = "12345671234561723456127345612374561327456137245613742561374526137456213745612347561324756134275613472561347526134756213475612345761234516723451627345162374516234751623457162345176234512673451263745126347512634571263451726345127634512367451236475123645712364517236451273645123764512346751234657123465172346512734651243765124367512436571243651724365127436512473651246375124635712463517246351274635124763512467351426735146273514672351467325146735216473521674352167345216374521634752163457216345271634521764352176453271645327614532764153276451326745132647513264571326451732645137264531726453712645372164537261453726415372645132764531276453217645231764521376452173654217365241736521473652174365217346521736452176345216735421637542163574216354721635427163542176354216735241637524163572416352741635247163524176352416735214673512465371246531724653127465312476531246753142675314627531467253146752316475321647531264753162475316427531647253164752316745321674531267453162745316724531674253167452316754231675243167523416752314675321467531246573124651372465132746513247651324671532467135246713254671235467125346712543671524367154236715432675143267541326754312675432167543261745362174536127453617245361742536174523617453261743526174325617432651742365174263517426531742651374265173426157342617534216753421765342175634217536421753462175342617354261734526173425617342651743261574362157436125743162574312657413265741236574126357412653741265734126574312567413256741235674125367412563741256734125674312576413257614325761342576132457613254761325746132576412357641253761425376124537612543761524376154237615432761543726154376215437612534761253746125376412573641257634125764312574631257436152743615724361574236157432617543621754361275436172543617524361754236175432671543627154367215436712546371254673125476312547361524736154273615472361547326145736214576321475632147653214763521476325147632154763214576231457621345762143576214537621457361245736142573614527361457236145732614753621475361247536142753614725361475236147532614735261473256147326514723651472635147265314726513472651437265147326154736215473612547316254731265471326547123654712635471265347126543716253471625374162537146253716425371624537162543716524371654237165432716543721654371265473125647132564712356471253647125634712564372156437251643275614327564132756431275643217564327156432751643257163425176342516734251637425163472516342751634257163245176324516732451637245163274516324751632457163254716325741632571463275146327154632714563271465327146352714632571643527164357216435712643517264351276435126743512647351264375126435716243517624351672435162743516247351624375162435716423517642351674235164723516427351642375146237514263751423675142376514273651427635142765314276513427651432765142375614235761423567143256714352671435627143567214356712435617243561274356124735612437561243576124356714235617423561472356142735614237516423571643251764325167432516473251643725614372564137256431725643712564731254671324567132465713246751324615732461753246173524617325416723541762354716235476123547621354762315467231546273154623715462317564231576421356742135647213564271356421735624137562413576241356724135627413562471356241735621473562174356217345621735462173564213756421357642153746215374261537421653742156374215367421537642157364215763421576432157642315674231564723156427315642371564231756243157624315672431562743156247315624371562431756234157623415672341562734156237415623471562341756231475623174562317546321745632174653217463521746325174632157463217546312754631725463175246315724631527463152476315246731524637152463175426315742631547263154276315426731542637154263175462315746235174623571462357416235746123574621357462315476235147623541726354172365417235641723546172354167253417625314762531746253176425317624531762543176524317654231765432176543127654317265431762534172653417256341725364172534617253416725431672541367251436725134672153476215347261534721653472156347215364721534672135467213456721346572136457213654721365742136572413657214365721346752136475213674521367542136752413675214376521437562143752614375216437521463725146372154637214563721465372146357214637521436752134672513647251367425136724513672541637254167325417632541736251473625174362517346257136425713624571362547136257413625714362571346275136427513624751362745136275416327541623754126375412367541237654132765413726541376251437625134762513746251376425137624513762541376524137654213765412375641237546132754613725461375246137542613754621375461237541627354126735412763541273654127356412735461273541627534126753412765341275634127536412753461275341627543162754136275143627513462715342671354267134526713425671342657143265714236571426357142653714265731426571342675134267153427615342716534271563427153642715346271354627134562713465271364527136542713652471365274136527143652713462573146257341625734612573462157346251736425173624517362541732654173256417325461732456173246517324615372461532746153247615324167532416573214657321645731264573162457316425731645273165427316524731652743165273416527314652731645723165472316574231657243165723416572314657231645732165473216574321657342165732416537241653274165324716532417653241567321456731245637124563172456312745631247563124576312456731425637142563174256314725631427563142576314256731452637145236714532671453627145367214536712453671425367145237614523716452371465237416523746152347651234765213476523147652341765234716523476152346715234617523461572346152734615237465123746521374652317465237145623714526317452631475263145726314527631452673145627314567231456732154673215647321567432156734215673241563724156327415632471563241756324157632415367241536274153624715362417536241573624153762415326741532647153264175326415732641523764152367415236471523641752364157236415273641526374152634715263417526341572634152763415267341526437152643175264315726431527643152674315264731526413752641357261435726134572613547261357426135724613572641352761435276134527613542761352476135274613527641352674135264713526417352641"

superperm_words = get_unique_words_in_string(superperm)
super_words = get_superwords(superperm_words)

print(f"{len(super_words)} super_words: {super_words}")

# print("123", "123456", offset("123", "123456"))
# print("123456", "123", offset("123456", "123"))
# print("111111", "1111123", offset("111111", "1111123"))
# print("1111112", "1111123", offset("1111112", "1111123"))
# print("11111123", "1111123", offset("11111123", "1111123"))


# words = get_words(7)
# solve_atsp(get_words(5), num_strings=3)
# # # get_optimal_solution(get_words(4), num_wildcards=0)
# exit()
#
words = get_words(3)
special_words = [w for w in words if w[:2] == '12']
free_words = [w for w in words if w not in special_words]
solve_atsp([special_words, special_words, special_words], free_words, words, num_strings=3, save_model=True, min_max_obj=False, dfj_model=False, mtz_model=True)
exit()

# words = get_words(7)
# special_words = [w for w in words if w[:2] == '12']
# free_words =  [w for w in words if w[:2] != '12']
# string = solve_atsp([special_words,special_words,special_words], free_words, special_words+free_words, num_strings=3)[0]
# exit()

words = get_words(7)
special_words = [w for w in words if w[:2] == '12']
free_words = [w for w in words if w[:2] != '12']
# get_optimal_solution(words, UB=2427, LB=2400, num_wildcards=0)

# string1 = "1234567123465712346751234671253467123546321754362175432617543216754321765471362546213754736215437621543167245316742531674523167453216745312674531627453167243651274365124736512437651243675124365712436517243654612375421637542671354126735421673524163752416357241635274163524716352417635241673521467351246375124635712463517246351274635124763512467351426735146273514672351467325146735216473521674352167345216374521634752163457216345271634521763452167354261375417326145736214573612457361425736145273614572361457623145762134576214357621453762145463172543617254317265461327546327154362715412376451237645471326457132645173264513726453172645371264537216453726145372641537264513276453127645321764532716453276145327641532764513267451326475132*462731541672345167234547213615742361574326157436215743612574316257431265741326574123657412635741265374126573412657431256741325674123567412536741256374125673412567431257643125746312574361527436152473615243761524367152436175243615724361547236154732617453621745361274536172453617425361745236174532617435261743256174326517423651742635174265317426513742651734261573426175342167534217653421756342175364217534621753426173452617342561734265174326751432675413726547261354271635427631542736154273167524316752341675231467532146753124657312465371246531724653127465312476531246753142675314627531467253146752316475321647531264753162475316427531647253164752316541632754127635421763542713654217365241736521473652174365217346521736452173654213675413276541736254673125476312547361254673215476321457632147563214765321476352147632514763215476231543726154372163547263154731625471263547216357421635*7612345761234756132475613427561347256134752613475621347561234754176234517623475162347546271354732165461723456172346517234654612734561273454126375421376452137645417263451276345126734512637451263475126345712634517263412576341254162734516273465127346513274651324765132467153246713524671354621735426317543126754317625471623457162345416732546713254672315463127543612754316271543267154327615432716542637154236715423761542371654613724561374256137452613745621374561237456132745613724651372465467213541623745162374541376254172364517236454136275413267543127654716325462317542361754231675423176452317643521764354276135417632547231654617325476132574613257641325761432576134257613245761325476213542617354267315416372546371254637215436721543716254123674512367454712364571236475123647547312654623712543671254376125347612537461253764125376142537612453761254371265413672541273645127364125736412357641235467123456"
# string2 = "6145732614235761423541672354162735462173546172354617325413267541236754362715463271456327146532714635271463257416325*4271634257163425176342516734251637425163472516342751634*4326175463217546371265473126547231654237165423176542361754263175426173546271354672135467312546713245671324657132467513246157324617532461735246173541623751462375142637514236751423765142736514276351427653142765134276514327651423756142375421637542137654327165432671546137254316725431267541263715426137541276354172635417362547316254732615472631547261354136275427136543217654321675421763543621734562173454367213456721346572136457213654721365742136572413657214365413726543172654361275463721542173654712365471326547136254371625347162537416253714625371642537162453716254376215421367541237654231675427316543276154276315427613541327654312765436172356417235614732561473526147356214735612473561427356147235617423561724356172546317254612735416372541367251436725134672541376254317625341726534712653472156347215364721534672153476215347216534726153472651437265147326514723651472635147265314726513472653417256341725364172534617253416725341762531476253174625317642531762453176254367126354712635431627546312754612371546237154126735462137542736154176325471632547236147523614753261475362147536124753614275361472536147623514762354176235471623547216354236715426371542167315462731546723154671235412736541723654173265437126543721654372615473621547361254732165243716524317652431567243156274351624735162437516243571642351764235167423516472351642735164237516423571643251764325167432516473251643725614372564137256431725643712564731256471325647123564712536471256347125643721564372516432756143275641327564312756432175643271564327516432571643527164357216435712643517264351276435126743512647351264375126435716243517624351672435162743561274356217435627143567214356712435671423567143256714352671435627413562471356241735624137562413576241356724135627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243154762315476321745632174653217463521746315247631524673152463715246317524631572463152746315742631574623517462357146235741623574612357462135746231574632157463251746325714632751463271546732154267315426713547621354761235476132541673254163274516324751632457163245176324516732451637245163274543761243576124375612437547631254613275423761****"
# string3 = "7214365721346752134672513647251367425136724513672547216354761325436172542637145263714256371425423176543216754213675423716452371645432617543271654273615476213547263145726314752631472563147254371625471326547231657423165724316572341657231465723164572316547236154732615436271453627145467231456723145473621546731245673124543267145326714543762154637214563721465372146357214637521436752143765214375621437526143752164375214637251463721546371245637124543127654632713456271345471263754126375432761543726154217365412736541327654132674153267413526471352641735264137524613752413675241376524137526413572614357261345726135742613572461357264157326415723641527364152376415236741523647152364175236415726341527634152673415263741526347152634175263415726431527643152674315264731526437152643175264315726413527641352674136257413624571362451736245*631274563127454763215467132547136254716327541632754613275463217547631245763124756312476153247615471236754123675421763541276354136725416372541673254176325417263547312645731264543217654213765423671452367142536714275631427564123756412735641275346127534162753412675341276534127563412753641275431672546137254617324561732465173246153724615327461532647153264175326417325641732546172354276135247613527461352761435276134527613542763145276314547612376541237654216735412673541627354167235436712453671245431726541372654173265417236542713652471365274136527143652713465271364527136542376145237614546712354216375426137542631745263174256317425476231546732156473215674321567342156732415637241563274156324715632417563241576324156732145673215462173546271354623175437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316241537624153672415362741536247153624175362415736241543621754236175436127354612735463172456317245437126547162375416237546123754621375462371456237146523741652374615234765123476521347652314765234176523471652347615234671523461752346157234615273461523746512374652137465231746523714654672135462731456273145267314521367452136475213642571364251736425*312675431627543176254137625143627513462751364275136247513627451362754136275143625714362517436251473625143762513476251374625137642513762451376254173625417623547261354721365427316524731652743165273416527314652731645273165427163542617354267134526713425671342657143265714236571426357142653714265731425673142576314257316425731462573416257346125734621573462517346257134625731426571342675134267153427615342716534271563427153642715346271534267135426731547361254231675437612543672145367214***"

#2507
string1 = '12345671234657123467512346712534671235463217543621754326175432167543217654713625462137547362154376215431672453167425316745231674532167453126745316274531672436512743651247365124376512436751243657124365172436546123754216375426713541267354216735241637524163572416352741635247163524176352416735214673512463751246357124635172463512746351247635124673514267351462735146723514673251467352164735216743521673452163745216347521634572163452716345217634521673542613754173261457362145736124573614257361452736145723614576231457621345762143576214537621454631725436172543172654613275463271543627154123764512376454713264571326451732645137264531726453712645372164537261453726415372645132764531276453217645327164532761453276415327645132674513264751326454627315416723451672345472136157423615743261574362157436125743162574312657413265741236574126357412653741265734126574312567413256741235674125367412563741256734125674312576431257463125743615274361524736152437615243671524361752436157243615472361547326174536217453612745361724536174253617452361745326174352617432561743265174236517426351742653174265137426517342615734261753421675342176534217563421753642175346217534261734526173425617342651743267514326754137265472613542716354276315427361542731675243167523416752314675321467531246573124653712465317246531274653124765312467531426753146275314672531467523164753216475312647531624753164275316472531647523165416327541276354217635427136542173652417365214736521743652173465217364521736542136754132765417362546731254763125473612546732154763214576321475632147653214763521476325147632154762315437261543721635472631547316254712635472163574216357547612345761234756132475613427561347256134752613475621347561234754176234517623475162347546271354732165461723456172346517234654612734561273454126375421376452137645417263451276345126734512637451263475126345712634517263412576341254162734516273465127346513274651324765132467153246713524671354621735426317543126754317625471623457162345416732546713254672315463127543612754316271543267154327615432716542637154236715423761542371654613724561374256137452613745621374561237456132745613724651372465467213541623745162374541376254172364517236454136275413267543127654716325462317542361754231675423176452317643521764354276135417632547231654617325476132574613257641325761432576134257613245761325476213542617354267315416372546371254637215436721543716254123674512367454712364571236475123647547312654623712543671254376125347612537461253764125376142537612453761254371265413672541273645127364125736412357641235467123456'
string3 = '7214365721346752134672513647251367425136724513672547216354761325436172542637145263714256371425423176543216754213675423716452371645432617543271654273615476213547263145726314752631472563147254371625471326547231657423165724316572341657231465723164572316547236154732615436271453627145467231456723145473621546731245673124543267145326714543762154637214563721465372146357214637521436752143765214375621437526143752164375214637251463721546371245637124543127654632713456271345471263754126375432761543726154217365412736541327654132674153267413526471352641735264137524613752413675241376524137526413572614357261345726135742613572461357264157326415723641527364152376415236741523647152364175236415726341527634152673415263741526347152634175263415726431527643152674315264731526437152643175264315726413527641352674136257413624571362451736245154631274563127454763215467132547136254716327541632754613275463217547631245763124756312476153247615471236754123675421763541276354136725416372541673254176325417263547312645731264543217654213765423671452367142536714275631427564123756412735641275346127534162753412675341276534127563412753641275431672546137254617324561732465173246153724615327461532647153264175326417325641732546172354276135247613527461352761435276134527613542763145276314547612376541237654216735412673541627354167235436712453671245431726541372654173265417236542713652471365274136527143652713465271364527136542376145237614546712354216375426137542631745263174256317425476231546732156473215674321567342156732415637241563274156324715632417563241576324156732145673215462173546271354623175437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316241537624153672415362741536247153624175362415736241543621754236175436127354612735463172456317245437126547162375416237546123754621375462371456237146523741652374615234765123476521347652314765234176523471652347615234671523461752346157234615273461523746512374652137465231746523714654672135462731456273145267314521367452136475213642571364251736425154312675431627543176254137625143627513462751364275136247513627451362754136275143625714362517436251473625143762513476251374625137642513762451376254173625417623547261354721365427316524731652743165273416527314652731645273165427163542617354267134526713425671342657143265714236571426357142653714265731425673142576314257316425731462573416257346125734621573462517346257134625731426571342675134267153427615342716534271563427153642715346271534267135426731547361254231675437612543672145367214'
string2 = '61457326142357614235416723541627354621735461723546173254132675412367543627154632714563271465327146352714632574163257454271634257163425176342516734251637425163472516342751634254326175463217546371265473126547231654237165423176542361754263175426173546271354672135467312546713245671324657132467513246157324617532461735246173541623751462375142637514236751423765142736514276351427653142765134276514327651423756142375421637542137654327165432671546137254316725431267541263715426137541276354172635417362547316254732615472631547261354136275427136543217654321675421763543621734562173454367213456721346572136457213654721365742136572413657214365413726543172654361275463721542173654712365471326547136254371625347162537416253714625371642537162453716254376215421367541237654231675427316543276154276315427613541327654312765436172356417235614732561473526147356214735612473561427356147235617423561724356172546317254612735416372541367251436725134672541376254317625341726534712653472156347215364721534672153476215347216534726153472651437265147326514723651472635147265314726513472653417256341725364172534617253416725341762531476253174625317642531762453176254367126354712635431627546312754612371546237154126735462137542736154176325471632547236147523614753261475362147536124753614275361472536147623514762354176235471623547216354236715426371542167315462731546723154671235412736541723654173265437126543721654372615473621547361254732165243716524317652431567243156274351624735162437516243571642351764235167423516472351642735164237516423571643251764325167432516473251643725614372564137256431725643712564731256471325647123564712536471256347125643721564372516432756143275641327564312756432175643271564327516432571643527164357216435712643517264351276435126743512647351264375126435716243517624351672435162743561274356217435627143567214356712435671423567143256714352671435627413562471356241735624137562413576241356724135627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243154762315476321745632174653217463521746315247631524673152463715246317524631572463152746315742631574623517462357146235741623574612357462135746231574632157463251746325714632751463271546732154267315426713547621354761235476132541673254163274516324751632457163245176324516732451637245163274543761243576124375612437547631254613275423761'

#2505
# string1 = '123456712346571234675123467125346712354632175436217543261754321675432176547136254621375473621543762154316724531674253167452316745321674531267453162745316724365127436512473651243765124367512436571243651724365461237542163754267135412673542167352416375241635724163527416352471635241763524167352146735124637512463571246351724635127463512476351246735142673514627351467235146732514673521647352167435216734521637452163475216345721634527163452176345216735426137541732614573621457361245736142573614527361457236145762314576213457621435762145376214546317254361725431726546132754632715436271541237645123764547132645713264517326451372645317264537126453721645372614537264153726451327645312764532176453271645327614532764153276451326745132647513264546273154167234516723454721361574236157432615743621574361257431625743126574132657412365741263574126537412657341265743125674132567412356741253674125637412567341256743125764312574631257436152743615247361524376152436715243617524361572436154723615473261745362174536127453617245361742536174523617453261743526174325617432651742365174263517426531742651374265173426157342617534216753421765342175634217536421753462175342617345261734256173426517432675143267541372654726135427163542763154273615427316752431675234167523146753214675312465731246537124653172465312746531247653124675314267531462753146725314675231647532164753126475316247531642753164725316475231654163275412763542176354271365421736524173652147365217436521734652173645217365421367541327654173625467312547631254736125467321547632145763214756321476532147635214763251476321547623154372615437216354726315473162547126354721635742163575476123457612347561324756134275613472561347526134756213475612347541762345176234751623475462713547321654617234561723465172346546127345612734541263754213764521376454172634512763451267345126374512634751263457126345172634125763412541627345162734651273465132746513247651324671532467135246713546217354263175431267543176254716234571623454167325467132546723154631275436127543162715432671543276154327165426371542367154237615423716546137245613742561374526137456213745612374561327456137246513724654672135416237451623745413762541723645172364541362754132675431276547163254623175423617542316754231764523176435217643542761354176325472316546173254761325746132576413257614325761342576132457613254762135426173542673154163725463712546372154367215437162541236745123674547123645712364751236475473126546237125436712543761253476125374612537641253761425376124537612543712654136725412736451273641257364123576412354671235'
# string2 = '61457326142357614235416723541627354621735461723546173254132675412367543627154632714563271465327146352714632574163257454271634257163425176342516734251637425163472516342751634254326175463217546371265473126547231654237165423176542361754263175426173546271354672135467312546713245671324657132467513246157324617532461735246173541623751462375142637514236751423765142736514276351427653142765134276514327651423756142375421637542137654327165432671546137254316725431267541263715426137541276354172635417362547316254732615472631547261354136275427136543217654321675421763543621734562173454367213456721346572136457213654721365742136572413657214365413726543172654361275463721542173654712365471326547136254371625347162537416253714625371642537162453716254376215421367541237654231675427316543276154276315427613541327654312765436172356417235614732561473526147356214735612473561427356147235617423561724356172546317254612735416372541367251436725134672541376254317625341726534712653472156347215364721534672153476215347216534726153472651437265147326514723651472635147265314726513472653417256341725364172534617253416725341762531476253174625317642531762453176254367126354712635431627546312754612371546237154126735462137542736154176325471632547236147523614753261475362147536124753614275361472536147623514762354176235471623547216354236715426371542167315462731546723154671234565412736541723654173265437126543721654372615473621547361254732165243716524317652431567243156274351624735162437516243571642351764235167423516472351642735164237516423571643251764325167432516473251643725614372564137256431725643712564731256471325647123564712536471256347125643721564372516432756143275641327564312756432175643271564327516432571643527164357216435712643517264351276435126743512647351264375126435716243517624351672435162743561274356217435627143567214356712435671423567143256714352671435627413562471356241735624137562413576241356724135627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243154762315476321745632174653217463521746315247631524673152463715246317524631572463152746315742631574623517462357146235741623574612357462135746231574632157463251746325714632751463271546732154267315426713547621354761235476132541673254163274516324751632457163245176324516732451637245163274543761243576124375612437547631254613275423761'
# string3 = '721436572134675213467251364725136742513672451367254721635476132543617254263714526371425637142542317654321675421367542371645237164543261754327165427361547621354726314572631475263147256314725437162547132654723165742316572431657234165723146572316457231654723615473261543627145362714546723145672314547362154673124567312454326714532671454376215463721456372146537214635721463752143675214376521437562143752614375216437521463725146372154637124563712454312765463271345627134547126375412637543276154372615421736541273654132765413267415326741352647135264173526413752461375241367524137652413752641357261435726134572613574261357246135726415732641572364152736415237641523674152364715236417523641572634152763415267341526374152634715263417526341572643152764315267431526473152643715264317526431572641352764135267413625741362457136245173624515463127456312745476321546713254713625471632754163275461327546321754763124576312475631247615324761547123675412367542176354127635413672541637254167325417632541726354731264573126454321765421376542367145236714253671427563142756412375641273564127534612753416275341267534127653412756341275364127543167254613725461732456173246517324615372461532746153264715326417532641732564173254617235427613524761352746135276143527613452761354276314527631454761237654123765421673541267354162735416723543671245367124543172654137265417326541723654271365247136527413652714365271346527136452713654237614523761454671235421637542613754263174526317425631742547623154673215647321567432156734215673241563724156327415632471563241756324157632415673214567321546217354627135462317543721654732165743216573421657324165372416532741653247165324176532416753241657321465732164573216547316245731624153762415367241536274153624715362417536241573624154362175423617543612735461273546317245631724543712654716237541623754612375462137546237145623714652374165237461523476512347652134765231476523417652347165234761523467152346175234615723461527346152374651237465213746523174652371465467213546273145627314526731452136745213647521364257136425173642512675431627543176254137625143627513462751364275136247513627451362754136275143625714362517436251473625143762513476251374625137642513762451376254173625417623547261354721365427316524731652743165273416527314652731645273165427163542617354267134526713425671342657143265714236571426357142653714265731425673142576314257316425731462573416257346125734621573462517346257134625731426571342675134267153427615342716534271563427153642715346271534267135426731547361254231675437612543672145367214712356'
string1 = '1234567123465712346751234671253467123546321754362175432617543216754321765471362546213754736215437621543167245316742531674523167453216745312674531627453167243651274365124736512437651243675124365712436517243654612375421637542671354126735421673524163752416357241635274163524716352417635241673521467351246375124635712463517246351274635124763512467351426735146273514672351467325146735216473521674352167345216374521634752163457216345271634521763452167354261375417326145736214573612457361425736145273614572361457623145762134576214357621453762145463172543617254317265461327546327154362715412376451237645471326457132645173264513726453172645371264537216453726145372641537264513276453127645321764532716453276145327641532764513267451326475132645462731541672345167234547213615742361574326157436215743612574316257431265741326574123657412635741265374126573412657431256741325674123567412536741256374125673412567431257643125746312574361527436152473615243761524367152436175243615724361547236154732617453621745361274536172453617425361745236174532617435261743256174326517423651742635174265317426513742651734261573426175342167534217653421756342175364217534621753426173452617342561734265174326751432675413726547261354271635427631542736154273167524316752341675231467532146753124657312465371246531724653127465312476531246753142675314627531467253146752316475321647531264753162475316427531647253164752316541632754127635421763542713654217365241736521473652174365217346521736452173654213675413276541736254673125476312547361254673215476321457632147563214765321476352147632514763215476231543726154372163547263154731625471263547216357421635754761234576123475613247561342756134725613475261347562134756123475417623451762347516234754627135473216546172345617234651723465461273456127345412637542137645213764541726345127634512673451263745126347512634571263451726341257634125416273451627346512734651327465132476513246715324671352467135462173542631754312675431762547162345716234541673254671325467231546312754361275431627154326715432761543271654263715423671542376154237165461372456137425613745261374562137456123745613274561372465137246546721354162374516237454137625417236451723645413627541326754312765471632546231754236175423167542317645231764352176435427613541763254723165461732547613257461325764132576143257613425761324576132547621354261735426731541637254637125463721543672154371625412367451236745471236457123647512364754731265462371254367125437612534761253746125376412537614253761245376125437126541367254127364512736412573641235764123546712354'
string2 = '7354261457326142357614235416723541627354621735461723546173254132675412367543627154632714563271465327146352714632574163257454271634257163425176342516734251637425163472516342751634254326175463217546371265473126547231654237165423176542361754263175426173546271354672135467312546713245671324657132467513246157324617532461735246173541623751462375142637514236751423765142736514276351427653142765134276514327651423756142375421637542137654327165432671546137254316725431267541263715426137541276354172635417362547316254732615472631547261354136275427136543217654321675421763543621734562173454367213456721346572136457213654721365742136572413657214365413726543172654361275463721542173654712365471326547136254371625347162537416253714625371642537162453716254376215421367541237654231675427316543276154276315427613541327654312765436172356417235614732561473526147356214735612473561427356147235617423561724356172546317254612735416372541367251436725134672541376254317625341726534712653472156347215364721534672153476215347216534726153472651437265147326514723651472635147265314726513472653417256341725364172534617253416725341762531476253174625317642531762453176254367126354712635431627546312754612371546237154126735462137542736154176325471632547236147523614753261475362147536124753614275361472536147623514762354176235471623547216354236715426371542167315462731546723154671235412736541723654173265437126543721654372615473621547361254732165243716524317652431567243156274351624735162437516243571642351764235167423516472351642735164237516423571643251764325167432516473251643725614372564137256431725643712564731256471325647123564712536471256347125643721564372516432756143275641327564312756432175643271564327516432571643527164357216435712643517264351276435126743512647351264375126435716243517624351672435162743561274356217435627143567214356712435671423567143256714352671435627413562471356241735624137562413576241356724135627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243154762315476321745632174653217463521746315247631524673152463715246317524631572463152746315742631574623517462357146235741623574612357462135746231574632157463251746325714632751463271546732154267315426713547621354761235476132541673254163274516324751632457163245176324516732451637245163274543761243576124375612437547631254613275423761'
string3 = '7214365721346752134672513647251367425136724513672547216354761325436172542637145263714256371425423176543216754213675423716452371645432617543271654273615476213547263145726314752631472563147254371625471326547231657423165724316572341657231465723164572316547236154732615436271453627145467231456723145473621546731245673124543267145326714543762154637214563721465372146357214637521436752143765214375621437526143752164375214637251463721546371245637124543127654632713456271345471263754126375432761543726154217365412736541327654132674153267413526471352641735264137524613752413675241376524137526413572614357261345726135742613572461357264157326415723641527364152376415236741523647152364175236415726341527634152673415263741526347152634175263415726431527643152674315264731526437152643175264315726413527641352674136257413624571362451736245154631274563127454763215467132547136254716327541632754613275463217547631245763124756312476153247615471236754123675421763541276354136725416372541673254176325417263547312645731264543217654213765423671452367142536714275631427564123756412735641275346127534162753412675341276534127563412753641275431672546137254617324561732465173246153724615327461532647153264175326417325641732546172354276135247613527461352761435276134527613542763145276314547612376541237654216735412673541627354167235436712453671245431726541372654173265417236542713652471365274136527143652713465271364527136542376145237614546712345654216375426137542631745263174256317425476231546732156473215674321567342156732415637241563274156324715632417563241576324156732145673215462173546271354623175437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316241537624153672415362741536247153624175362415736241543621754236175436127354612735463172456317245437126547162375416237546123754621375462371456237146523741652374615234765123476521347652314765234176523471652347615234671523461752346157234615273461523746512374652137465231746523714654672135462731456273145267314521367452136475213642571364251736425154312675431627543176254137625143627513462751364275136247513627451362754136275143625714362517436251473625143762513476251374625137642513762451376254173625417623547261354721365427316524731652743165273416527314652731645273165427163542617354267134526713425671342657143265714236571426357142653714265731425673142576314257316425731462573416257346125734621573462517346257134625731426571342675134267153427615342716534271563427153642715346271534267135426731547361254231675437612543672145367214'


string1= '54621374562137454163275473126154327614532761454317264531726454673215476213542617345261734256173426517342615734261753421675342176534217563421753642175346217534261754231675243167523416752314675321467531246573124653712465317246531274653124765312467531426753146275314672531467523164753216475312647531624753164275316472531647523167453216745312674531627453167245316742531674523167543217645321764352176435431672541672345167234541732645173264543726145372614543712645371264541367254123674512367454173625417236517423651724365127436512473651243765124367512436571243651723465172364517236541362754312675431276453127645471236457123647512364754127634512763412576341254132764513276415327641542631754732614573621457361245736142573614527361457236145762314576213457621435762145376214542673154163725463712546731254763214576321475632147653214763521476325147632543672154367125426713547132645713264751326475463217543627154371625471263457126347512634754327164532716454127364512736412573641235764123546712345671234657123467512346713524671354716325431762547613257461325764132576143257613425761324576132546713254617325417623451762345461723456172345416237451623745412637451263745476123457612347561324756134275613472561347526134756213475612347546132745613274541763254723165461273456127346512734651327465132476513246715324671253467125463721547631254736215437621543162754632715467213543621745362174542136754132674513267454236715423617452361742536174265317426546317254361274536127454621735426137452613742561374265137426351742635472163547261354217635421736524173652147365217436521734652173645217365421376452137645417263451726345427631542761354216735241637524163572416352741635247163524176352416735214673512463751246357124635172463512746351247635124673514267351462735146723514673251467352164735216743521673452163745216347521634572163452716345217634521673542163754723615742361574326157436215743612574316257431265741326574123657412635741265374126573412657431256741325674123567412536741256374125673412567431257643125746312574361524736152437615243671524361752436157243615274361547213654623175432671543216754231764523176454372164537216454123764512376454631275436172453617245476231542637154326174532617435261743256174326517432675143267541376254716234571623475162347542716354271365471362546123745612374541372645137264153726415472631547316254732163574216357541673254736125437612534761253746125376412537614253761245376125416273451627345462371542376154237165461372456137246513724654672315462713546273154273615427316541267345126734'
string2= '542376154236715462371546273154627135461372546317254637125436172354613275461237547631254136725143672513467254136275432167542136754132675413762543176253417265341725634172536417253461725341672534176253147625317462531764253176245317625437162534716253741625371462537164253716245371625431672543162754621375421673541623754163274516327454671235461732541672354167324516732454367125436127543621754326715426371542673154267135461723564172356542361754263175426137541267354273165423716542317654271365421736541627354126375412367541276354176324517632475163247541327654312765436271546327145632714653271463527146315724631527463152476315246731524637152463175246315742631574623517462357146235741623574612357462135746231574632157463541637245163724543762154726315472613547621354671324567132465713246751324615732461753246173524617354137265431726543712654372165437261547326154723615426173542716354127365421637542137654327165432761457326147536214753612475361427536147253614752361475326147352614732561473265147236514726351472653147265134726514372651473265471326534712653476215347261534721653472156347215364721534672153476235147623541762354716235476123547613254716325741632571463257164352716435721643571264351726435127643512674351264735126437512643571624351762435167243516274351624735162437516243571642351764235167423516472351642735164237514623751426375142367514237651427365142763514276531427651342765143276514237561423576142356714325671435267143562714356721435671243561724356127435612473561243756124357612435671423561742356147235614273561423751642357164325176432516743251647325164372561437256413725643172564371256473125647132564712356471253647125634712564372156437251643275614327564132756431275643217564327156432751643257163425176342516734251637425163472516342751634257163245716325471236547216354712635471362542176354172635417326547312654723165243716524317652431543261754632174563217465321746352174632517463275146327546312754637215427631546723154762315476321546127354621735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243156724315627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735624137562413576241356724135627413562471356241735621473562174356217345621735467312546732154276135467213456721346572136457213654721365742136572413657214365417236541736254731625437612543126754123765432176542316754273615436721547362154736125473216'
string3= '5463127456312745437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316245471632547612354671235426713542673145267314256731425462137546217354623175431726541372654173265417263543762154673215647321567432156734215673241563724156327415632471563241756324157632415673214567321546713254761325416732541763254176235421736541237654123675423617543261754371625471326547361254367214536721436572134675213467251364725136742513675421637542613754263714526371425637142543126754317625413762514376251347625137462513764251376245137625417362547126354371265473261542176354126735416273546127354167235462713456271345427163542761352476135274613527641352761435276134527613547263145726314752631472563147254721635423761452376145431276542136745213674542316754316275431672547631245763124756312476153247615437261543761254731264573126417352641732564173254617235472613574261357246135726413572614357261345726135427631452763142576314275631427546132754163275412637541623754612375462731456273145423716452371642573164257546327154362714536271454672314567231454723165742316572431657234165723146572316457231654723615473621546372145637214653721463572146375214367521437652143756214375261437521643752146372514637254163725461372154637124563712454321765436217542367145236714253671425471362574136257143625713462573146257341625734612573462157346251736425173624517362514736251743625173462571364257136245713625472136542713652471365274136527143652713465271364527136475213647542617354263174526317425631742542137654216735412763543276154326713452671342567134265714326571423657142635714265371426573142657134267513426715342761534271653427156342715364271534627153426714532671454172365471236541273654132765413267415326741352674137526413752461375241367524137652413754136275143627513462751364275136247513627451362754136724513672415362741536247153624175362415736241537624153672415432167543612753461275341627534126753412765341275641237564127356412753641275634127546173245617324651732461537246153274615326471523641752364157236415273641523764152367415236471526341752634157263415276341526734152637415263471526473152643715264317526431572643152764315267431526471352647153264175326415732641543617254367124536712454231765432716542731652473165274316527341652731465273164527316542736154762135476321547162354762315467312456731245467213546321754631724563172454623714562371465237416523746152347651234765213476523147652341765234716523476152346715234617523461572346152734615237465123746521374652317465237146'

string1= '54621374562137454163275473126154327614532761454317264531726454673215476213542617345261734256173426517342615734261753421675342176534217563421753642175346217534261754231675243167523416752314675321467531246573124653712465317246531274653124765312467531426753146275314672531467523164753216475312647531624753164275316472531647523167453216745312674531627453167245316742531674523167543217645321764352176435431672541672345167234541732645173264543726145372614543712645371264541367254123674512367454173625417236517423651724365127436512473651243765124367512436571243651723465172364517236541362754312675431276453127645471236457123647512364754127634512763412576341254132764513276415327641542631754732614573621457361245736142573614527361457236145762314576213457621435762145376214542673154163725463712546731254763214576321475632147653214763521476325147632543672154367125426713547132645713264751326475463217543627154371625471263457126347512634754327164532716454127364512736412573641235764123546712345671234657123467512346713524671354716325431762547613257461325764132576143257613425761324576132546713254617325417623451762345461723456172345416237451623745412637451263745476123457612347561324756134275613472561347526134756213475612347546132745613274541763254723165461273456127346512734651327465132476513246715324671253467125463721547631254736215437621543162754632715467213543621745362174542136754132674513267454236715423617452361742536174265317426546317254361274536127454621735426137452613742561374265137426351742635472163547261354217635421736524173652147365217436521734652173645217365421376452137645417263451726345427631542761354216735241637524163572416352741635247163524176352416735214673512463751246357124635172463512746351247635124673514267351462735146723514673251467352164735216743521673452163745216347521634572163452716345217634521673542163754723615742361574326157436215743612574316257431265741326574123657412635741265374126573412657431256741325674123567412536741256374125673412567431257643125746312574361524736152437615243671524361752436157243615274361547213654623175432671543216754231764523176454372164537216454123764512376454631275436172453617245476231542637154326174532617435261743256174326517432675143267541376254716234571623475162347542716354271365471362546123745612374541372645137264153726415472631547316254732163574216357541673254736125437612534761253746125376412537614253761245376125416273451627345462371542376154237165461372456137246513724654672315462713546273154273615427316541267345126734'
string2= '542376154236715462371546273154627135461372546317254637125436172354613275461237547631254136725143672513467254136275432167542136754132675413762543176253417265341725634172536417253461725341672534176253147625317462531764253176245317625437162534716253741625371462537164253716245371625431672543162754621375421673541623754163274516327454671235461732541672354167324516732454367125436127543621754326715426371542673154267135461723564172356542361754263175426137541267354273165423716542317654271365421736541627354126375412367541276354176324517632475163247541327654312765436271546327145632714653271463527146315724631527463152476315246731524637152463175246315742631574623517462357146235741623574612357462135746231574632157463541637245163724543762154726315472613547621354671324567132465713246751324615732461753246173524617354137265431726543712654372165437261547326154723615426173542716354127365421637542137654327165432761457326147536214753612475361427536147253614752361475326147352614732561473265147236514726351472653147265134726514372651473265471326534712653476215347261534721653472156347215364721534672153476235147623541762354716235476123547613254716325741632571463257164352716435721643571264351726435127643512674351264735126437512643571624351762435167243516274351624735162437516243571642351764235167423516472351642735164237514623751426375142367514237651427365142763514276531427651342765143276514237561423576142356714325671435267143562714356721435671243561724356127435612473561243756124357612435671423561742356147235614273561423751642357164325176432516743251647325164372561437256413725643172564371256473125647132564712356471253647125634712564372156437251643275614327564132756431275643217564327156432751643257163425176342516734251637425163472516342751634257163245716325471236547216354712635471362542176354172635417326547312654723165243716524317652431543261754632174563217465321746352174632517463275146327546312754637215427631546723154762315476321546127354621735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243156724315627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735624137562413576241356724135627413562471356241735621473562174356217345621735467312546732154276135467213456721346572136457213654721365742136572413657214365417236541736254731625437612543126754123765432176542316754273615436721547362154736125473216'
string3= '5463127456312745437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316245471632547612354671235426713542673145267314256731425462137546217354623175431726541372654173265417263543762154673215647321567432156734215673241563724156327415632471563241756324157632415673214567321546713254761325416732541763254176235437162547132654736125436721453672143657213467521346725136472513674251367542163754261375426371452637142563714254312675431762541376251437625134762513746251376425137624513762541736254712635437126547326154217635412673541627354612735416723546271345627134542716354276135247613527461352764135276143527613452761354726314572631475263147256314725472163542376145237614543127654213674521367454231675421736541237654123675423617543261754316275431672547631245763124756312476153247615437261543761254731264573126417352641732564173254617235472613574261357246135726413572614357261345726135427631452763142576314275631427546132754163275412637541623754612375462731456273145423716452371642573164257546327154362714536271454672314567231454723165742316572431657234165723146572316457231654723615473621546372145637214653721463572146375214367521437652143756214375261437521643752146372514637254163725461372154637124563712454321765436217542367145236714253671425471362574136257143625713462573146257341625734612573462157346251736425173624517362514736251743625173462571364257136245713625472136542713652471365274136527143652713465271364527136475213647542617354263174526317425631742542137654216735412763543276154326713452671342567134265714326571423657142635714265371426573142657134267513426715342761534271653427156342715364271534627153426714532671454172365471236541273654132765413267415326741352674137526413752461375241367524137652413754136275143627513462751364275136247513627451362754136724513672415362741536247153624175362415736241537624153672415432167543612753461275341627534126753412765341275641237564127356412753641275634127546173245617324651732461537246153274615326471523641752364157236415273641523764152367415236471526341752634157263415276341526734152637415263471526473152643715264317526431572643152764315267431526471352647153264175326415732641543617254367124536712454231765432716542731652473165274316527341652731465273164527316542736154762135476321547162354762315467312456731245467213546321754631724563172454623714562371465237416523746152347651234765213476523147652341765234716523476152346715234617523461572346152734615237465123746521374652317465237146'

# string1 = '541673254716325431762547213654623175431627546327154631725436172453617245437126453712645413672541376254716234571623475162347546721354163275463712546173254173625416723451672345467231546712345671234657123467512346712534671254637215436712543172645317264547123645712364751236475412763451276341257634125427163547216357421635754617234561723454162374516237454723165471263457126345473126154327164532716454127364512736412573641235764123547613257461325764132576143257613425761324576132546713254673125476321457632147563214765321476352147632514763254372164537216454123764512376454631275436127453612745421367541326745132674547326145736214573612457361425736145273614572361457623145762134576214357621453762145426731541637254362174536217454173264517326454762315476213542613745261374256137426513742635174263542713654612374561237454723615742361574326157436215743612574316257431265741326574123657412635741265374126573412657431256741325674123567412536741256374125673412567431257643125746312574361527436152473615243761524367152436175243615724361547261354217635421736524173652147365217436521734652173645217365421376452137645417263451726347512634754613274561327454176325471326457132647513264754632175436271543261745326174352617432561743265174326751432675431276453127645462371542361745236174253617426531742654236715423761542371654613724561372465137246513274651324765132467153246713524671354627315427613542167352416375241635724163527416352471635241763524167352146735124637512463571246351724635127463512476351246735142673514627351467235146732514673521647352167435216734521637452163475216345721634527163452176345216735421637541327645132764153276415426317542763154273615427316541267345126735412367451236745462713541263745126374547612345761234756132475613427561347256134752613475621347561234754267135436721543762154371625473216546732154763125473612543761253476125374612537641253761425376124537612541627345162734543216754231675243167523416752314675321467531246573124653712465317246531274653124765312467531426753146275314672531467523164753216475312647531624753164275316472531647523167453216745312674531627453167245316742531674523167543217645321764352176435431672541362754312675473162547136254176234517623454137264513726415372641547263154263715462137456213745461273456127346512734654372614537261454326715432761453276145462173542617345261734256173426517342615734261753421675342176534217563421753642175346217534261754231764523176454736215417236517423651724365127436512473651243765124367512436571243651723465172364517236'
# string1 = '54621374562137454163275473126154327614532761454317264531726454673215476213542617345261734256173426517342615734261753421675342176534217563421753642175346217534261754231675243167523416752314675321467531246573124653712465317246531274653124765312467531426753146275314672531467523164753216475312647531624753164275316472531647523167453216745312674531627453167245316742531674523167543217645321764352176435431672541672345167234541732645173264543726145372614543712645371264541367254123674512367454173625417236517423651724365127436512473651243765124367512436571243651723465172364517236541362754312675431276453127645471236457123647512364754127634512763412576341254132764513276415327641542631754732614573621457361245736142573614527361457236145762314576213457621435762145376214542673154163725463712546731254763214576321475632147653214763521476325147632543672154367125426713547132645713264751326475463217543627154371625471263457126347512634754327164532716454127364512736412573641235764123546712345671234657123467512346713524671354716325431762547613257461325764132576143257613425761324576132546713254617325417623451762345461723456172345416237451623745412637451263745476123457612347561324756134275613472561347526134756213475612347546132745613274541763254723165461273456127346512734651327465132476513246715324671253467125463721547631254736215437621543162754632715467213543621745362174542136754132674513267454236715423617452361742536174265317426546317254361274536127454621735426137452613742561374265137426351742635472163547261354217635421736524173652147365217436521734652173645217365421376452137645417263451726345427631542761354216735241637524163572416352741635247163524176352416735214673512463751246357124635172463512746351247635124673514267351462735146723514673251467352164735216743521673452163745216347521634572163452716345217634521673542163754723615742361574326157436215743612574316257431265741326574123657412635741265374126573412657431256741325674123567412536741256374125673412567431257643125746312574361524736152437615243671524361752436157243615274361547213654623175432671543216754231764523176454372164537216454123764512376454631275436172453617245476231542637154326174532617435261743256174326517432675143267541376254716234571623475162347542716354271365471362546123745612374541372645137264153726415472631547316254732163574216357541673254736125437612534761253746125376412537614253761245376125416273451627345462371542376154237165461372456137246513724654672315462713546273154273615427316541267345126734'
# string2 = '542376154236715462371546273154627135461372546317254637125436172354613275461237547631254136725143672513467254136275432167542136754132675413762543176253417265341725634172536417253461725341672534176253147625317462531764253176245317625437162534716253741625371462537164253716245371625431672543162754621375421673541623754163274516327454671235461732541672354167324516732454367125436127543621754326715426371542673154267135461723564172356542361754263175426137541267354273165423716542317654271365421736541627354126375412367541276354176324517632475163247541327654312765436271546327145632714653271463527146315724631527463152476315246731524637152463175246315742631574623517462357146235741623574612357462135746231574632157463541637245163724543762154726315472613547621354671324567132465713246751324615732461753246173524617354137265431726543712654372165437261547326154723615426173542716354127365421637542137654327165432761457326147536214753612475361427536147253614752361475326147352614732561473265147236514726351472653147265134726514372651473265471326534712653476215347261534721653472156347215364721534672153476235147623541762354716235476123547613254716325741632571463257164352716435721643571264351726435127643512674351264735126437512643571624351762435167243516274351624735162437516243571642351764235167423516472351642735164237514623751426375142367514237651427365142763514276531427651342765143276514237561423576142356714325671435267143562714356721435671243561724356127435612473561243756124357612435671423561742356147235614273561423751642357164325176432516743251647325164372561437256413725643172564371256473125647132564712356471253647125634712564372156437251643275614327564132756431275643217564327156432751643257163425176342516734251637425163472516342751634257163245716325471236547216354712635471362542176354172635417326547312654723165243716524317652431543261754632174563217465321746352174632517463275146327546312754637215427631546723154762315476321546127354621735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243156724315627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735624137562413576241356724135627413562471356241735621473562174356217345621735467312546732154276135467213456721346572136457213654721365742136572413657214365417236541736254731625437612543126754123765432176542316754273615436721547362154736125473216'
# string3 = '5463127456312745437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316245471632547612354671235426713542673145267314256731425462137546217354623175431726541372654173265417263543762154673215647321567432156734215673241563724156327415632471563241756324157632415673214567321546713254761325416732541763254176235437162547132654736125436721453672143657213467521346725136472513674251367542163754261375426371452637142563714254312675431762541376251437625134762513746251376425137624513762541736254712635437126547326154217635412673541627354612735416723546271345627134542716354276135247613527461352764135276143527613452761354726314572631475263147256314725472163542376145237614543127654213674521367454231675421736541237654123675423617543261754316275431672547631245763124756312476153247615437261543761254731264573126417352641732564173254617235472613574261357246135726413572614357261345726135427631452763142576314275631427546132754163275412637541623754612375462731456273145423716452371642573164257546327154362714536271454672314567231454723165742316572431657234165723146572316457231654723615473621546372145637214653721463572146375214367521437652143756214375261437521643752146372514637254163725461372154637124563712454321765436217542367145236714253671425471362574136257143625713462573146257341625734612573462157346251736425173624517362514736251743625173462571364257136245713625472136542713652471365274136527143652713465271364527136475213647542617354263174526317425631742542137654216735412763543276154326713452671342567134265714326571423657142635714265371426573142657134267513426715342761534271653427156342715364271534627153426714532671454172365471236541273654132765413267415326741352674137526413752461375241367524137652413754136275143627513462751364275136247513627451362754136724513672415362741536247153624175362415736241537624153672415432167543612753461275341627534126753412765341275641237564127356412753641275634127546173245617324651732461537246153274615326471523641752364157236415273641523764152367415236471526341752634157263415276341526734152637415263471526473152643715264317526431572643152764315267431526471352647153264175326415732641543617254367124536712454231765432716542731652473165274316527341652731465273164527316542736154762135476321547162354762315467312456731245467213546321754631724563172454623714562371465237416523746152347651234765213476523147652341765234716523476152346715234617523461572346152734615237465123746521374652317465237146'

string1 = '547162345716234751623475461273456127346512734654623715431726453172645416732542137645213764546732154762135462173542613745261374256137426513742635174263542716354721635742163575471236457123647512364754671325467123456712346571234675123467135246713547261354126374512637454761325746132576413257614325761342576132457613254276315427613542176354217365241736521473652174365217346521736452173654261734526173425617342651734261573426175342167534217653421756342175364217534621753426175423716542167352416375241635724163527416352471635241763524167352146735124637512463571246351724635127463512476351246735142673514627351467235146732514673521647352167435216734521637452163475216345721634527163452176345216735421637547136254721365413267451326745463217543627154362174536217454167234516723454367215436712543762154376125347612537461253764125376142537612453761254371264537126454372164537216454321675423761543271645327164543716254631275436127453612745413627546123745612374543127645312764542637154162734516273454672135417623451762345412376451237645412367451236745471632547362154672315462137456213745472316546137245613724651372465132746513247651324671532467125346712546371254673125476312547361254627315472361574236157432615743621574361257431625743126574132657412365741263574126537412657341265743125674132567412356741253674125637412567341256743125764312574631257436152743615427316547132645713264751326475423671542361745236174253617426531742654163725413726451372641537264154273615247361524376152436715243617524361572436154613274561327454762315426317546327154631725461732541632754231764523176454637215476321457632147563214765321476352147632514763254136725412763451276341257634125462317543176254761234576123475613247561342756134725613475261347562134756123475416237451623745412673451267345412736451273641257364123576412354213675423167524316752341675231467532146753124657312465371246531724653127465312476531246753142675314627531467253146752316475321647531264753162475316427531647253164752316745321674531267453162745316724531674253167452316754321764532176435217643541327645132764153276415431627541732645173264547312654267135462713541723651742365172436512743651247365124376512436751243657124365172346517236451723654137625473162547326145736214573612457361425736145273614572361457623145762134576214357621453762145417362541763254726315432761453276145431672543617245361724542713654732165417263451726345426731547126345712634751263475432671543261745326174352617432561743265174326751432675431267543726145372614546172345617234'
string2 = '542376154236715462371546273154627135461372546317254637125436271546327145632714653271463527146315274631524763152467315246371524631752463157246315742631574623517462357146235741623574612357462135746231574632157463541273654327165432761457326147536214753612475361427536147253614752361475326147352614732561473265147236514726351472653147265134726514372651473265471326534712653476215347261534721653472156347215364721534672153476235147623541762354716235476123547613254716325741632571463257164352716435721643571264351726435127643512674351264735126437512643571624351762435167243516274351624735162437516243571642351764235167423516472351642735164237514623751426375142367514237651427365142763514276531427651342765143276514237561423576142356714325671435267143562714356721435671243561724356127435612473561243756124357612435671423561742356147235614273561423751642357164325176432516743251647325164372561437256413725643172564371256473125647132564712356471253647125634712564372156437251643275614327564132756431275643217564327156432751643257163425176342516734251637425163472516342751634257163245716325471236547216354712635471362547316254136725143672513467254136275432167542136754132675413762543176253417265341725634172536417253461725341672534176253147625317462531764253176245317625437162534716253741625371462537164253716245371625437612543167254316275462137541236754123765461273546217356421375642135764215374621537426153742165374215637421536742153764215736421576342157643215764231567423156472315642731564237156423175624315762431567243156274315624731562437156243175623415762341567234156273415623741562347156234175623147562317456231754623175642315764213567421356472135642713564217356241375624135762413567241356274135624713562417356214735621743562173456217354673125467321541372654317265437126543721654372615473261547236154276315437621547263154726135476213546721345672134657213645721365472136574213657241365721436541723654173625467132456713246571324675132461573246175324617352461735427163546172356417235654271365421763543126754362175432671542637154267315426713542731654237165423176542316754273615412763541726354176324517632475163247547631254236175426317542613754216735416273541263754126735432617546321745632174653217463521746325174632751463275463127546372154736215473612547321652437165243176524315467231547623154763215436721546712354617325416723541673245167324541327654312765432176541623754163724516372454276135426173541732654731265472316542173654216375421376543612754367125436172354613275461237541632745163274'
string3 = '5463127456312745437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316245431267543176254137625143762513476251374625137642513762451376254173625471362574136257143625713462573146257341625734612573462157346251736425173624517362514736251743625173462571364257136245713625472136542713652471365274136527143652713465271364527136475213647543276154326713452671342567134265714326571423657142635714265371426573142657134267513426715342761534271653427156342715364271534627153426714532671454317265413726541732654172365471236541273654132765413267415326741352674137526413752461375241367524137652413754136275143627513462751364275136247513627451362754136724513672415362741536247153624175362415736241537624153672415432167543612753461275341627534126753412765341275641237564127356412753641275634127546173245617324651732461537246153274615326471523641752364157236415273641523764152367415236471526341752634157263415276341526734152637415263471526473152643715264317526431572643152764315267431526471352647153264175326415732641546237145623714652374165237461523476512347652134765231476523417652347165234761523467152346175234615723461527346152374651237465213746523174652371465437621546732156473215674321567342156732415637241563274156324715632417563241576324156732145673215467132547613254761235467123547362154637214563721465372146357214637521436752143765214375621437526143752164375214637251463725416372546137215463712456371245472163542761352476135274613527641352761435276134527613547261357426135724613572641357261435726134572613542763145276314257631427563142754613275416327541263754162375461237546273145627314547231657423165724316572341657231465723164572316547236154726314572631475263147256314725476312457631247563124761532476154372615437126547312645731264173526417325641732546172354263714526371425637142543617254367124536712454736125436721453672143657213467521346725136472513674251367542163754261375426173542631745263174256317425423176543271654273165247316527431652734165273146527316452731654271635427361542376145237614542371645237164257316425754632175463271543627145362714542176354126735412763547126354231675432617543162754316725417263546271345627134547621354762315467213546723145672314546213754621735462317542361754321765437162547132654716325416732541763254176235423671452367142536714254312765421376542173654123765412367546317245631724543621754673124567312454213674521367454763215471623542167354162735461273541672354267135426731452673142567314254732615437612'

string1 = '123764512374652137465231746523714652374165237461523746512374561235476213547623154762351476235417623547162354761235467125346721534672513467253146725341672534617253461253476127534621753462715346275134627531462753416275341275364123675421367542316754236175423671542367514236754123674512364752136475231647523614752364175236471523647512364571265437216543726154372651437265413726543172654312654731243567124357612436571243675124375612437651246357124637512475361274536217453627145362741536274513627453162745312745631254637125467312547361254763125674321567432516743256174325671432567413256743125673412365742136574231657423615742365174236571423657412365471254367215436725143672541367254316725436172543612543761274356217435627143562741356274315627435162743512743651273645217364527136452731645273614527364152736412736541237654213765423176542371654237615423765142376541237564213756423175642371564237516423756142375612375461234576213457623145762341576234517623457162345761234567126345721634572613457263145726341572634517263451263475123467521346752314675234167523461752346715234675123476521347652314765234176523471652347615234765123475612734562173456271345627314562734156273451627345127346512763452176345271634527613452763145276341527634127635412765342176534271653427615342765134276531427653127654312346571264537216453726145372641537264513726453172645312645731253647125367412537461253764125734612573641257436125746312457632145763241576324517632457163245761324576124573612754361275463124756321475632417563247156324751632475613247561247356124736512563471256374125643712564731257643215764325176432571643257614325764132576431257634127563421756342715634275163427561342756314275631275643124675321467532416753246175324671532467513246753124673512746352174635271463527416352746135274631527463127465312476532147653241765324716532476153247651324765312465732146573241657324615732465173246571324657312465371264357216435726143572641357264315726435172643512643751276435217643527164352761435276413527643152764312764531245673214567324156732451673245617324567132456731245637126534721653472615347265134726531472653417265341265374123567421356742315674235167423561742356714235671235746127354621735462713546273154627351462735416273541273564123576421357642315764235176423571642357614235764123564712635472163547261354726315472635147263541726354126357412453671245376124763512657341265743126374512637541264735126475312674351267453126734512673541267534126754362175436271543627514362754136275431627543'
string2 = '12534671253476125436712543761235746213574623157462351746235714623574162357461235764125376421537642513764253176425371642537614253764125374612453762145376241537624513762453176245371624537612453671235467213546723154672351467235416723546172354671235647213564723156472351647235614723564172356471235674125763421576342517634257163425761342576314257634125764312634571263475126354712635741265347126537412654371265473126435712643751264735124736521473652417365247136524731652473615247365124735612475362147536241753624715362475136247531624753612475631267453216745326174532671453267415326745132674531267435124673521467352416735246173524671352467315246735124675312647532164753261475326417532647153264751326475312645371264573126754321675432617543267154326751432675413267543126753412637542163754261375426317542637154263751426375412637451243765214376524137652431765243716524376152437651243756124573621457362415736245173624571362457316245736124576312574632157463251746325714632574163257461325746312574361237456213745623174562371456237415623745162374561237465124637521463752416375246137524631752463715246375124635712346572134657231465723416572346157234651723465712345761234756213475623147562341756234715623475162347561234765123674521367452316745236174523671452367415236745123675412673542167354261735426713542673154267351426735412673451237645213764523176452371645237614523764152376451237654125673421567342516734256173425671342567314256734125674312547632154763251476325417632547163254761325476312547361243576214357624135762431576243517624357162435761243567123456721345672314567234156723451672345617234567123467512476352147635241763524716352476135247631524763512476531254673215467325146732541673254617325467132546731254637124563721456372415637245163724561372456317245637124567312657432165743261574326517432657143265741326574312657341257364215736425173642571364257316425736142573641257346123754621375462317546237154623751462375416237546123756412536742153674251367425316742536174253671425367412536471235476123657412563742156374251637425613742563174256371425637412563471236547213654723165472361547236514723654172365471236457213645723164572361457236415723645172364571236475124367521436752413675243167524361752436715243675124365712465372146537241653724615372465137246531724653712465731256473215647325164732561473256417325647132564731256437127354612735641273456127346512736451273654127543612754631275346127536412756341275643127435612743651274536127456312746351274653127634512763541276435127645312765341276543'
string3 = '12465371246573124673512467531247635124765312746532174653271465327416532746153274651327465127463512634752163475261347526314752634175263471526347512634571234567123457612346571234675123475612347651236457123647512365471236574123674512367541235647123567412354671235476123574612357641237546123756412374561237465123764512376541276354217635427163542761354276315427635142763512763451267345216734526173452671345267314526734152673451267354126357421635742613574263157426351742635714263574126354712564372156437251643725614372564137256431725643712564731265473216547326154732651473265417326547132654712654371256347215634725163472561347256314725634172563471256374126753421675342617534267153426751342675314267534126754312645732164573261457326415732645173264571326457312645371245367214536724153672451367245316724536172453671245376124375621437562413756243175624371562437516243756124376512734652173465271346527314652734165273461527346127345612574362157436251743625714362574136257431625743612574631275463217546327154632751463275416327546132754631275643217564327156432751643275614327564132756431275634127365421736542713654273165427361542736514273654127364512743652174365271436527413652743165274361527436512743561247356214735624173562471356247315624735162473512475361247563124736512674352167435261743526714352674135267431526743512674531276453217645327164532761453276415327645132764512764351264735216473526147352641735264713526473152647351264357124635721463572416357246135724631572463517246357124637512643752164375261437526413752643175264371526437126475312765432176543271654327615432765143276541327654312765341275364217536427153642751364275316427536142753641275346125734621573462517346257134625731462573416257346125347621534762513476253147625341762534716253476125346712435672143567241356724315672435167243561724356712436572143657241365724316572436157243651724365712436751263745216374526137452631745263714526374152637451263754126537421653742615374265137426531742653714265371265347125463721546372514637254163725461372546317254637125467312745632174563271456327415632745163274561327456312745361254736215473625147362541736254713625473162547361254763124563712456731245736124576312435761254376215437625143762541376254317625437162543761254367125364721536472513647253164725361472536417253647125367412573641273564217356427135642731564273516427356142735612735461253746215374625137462531746253714625374162537461253764126573421657342615734265173426571342657314265734126574312754361256734125674312576341257643'

string1 = '12657431256743215674325167432561743256714325674132567412453761253764123576421357642315764235176423571642357614235761267453127356412537461273546217354627135462731546273514627354162735412375642137564231756423715642375164237561423756126547312465732146573241657324615732465173246571324657124536712645372164537261453726415372645137264531726453126735412573641243675123645712473561246537125743612754362175436271543627514362754136275431627543125647312763541276534217653427165342761534276513427653142765312467532146753241675324617532467153246751324675126457312456732145673241567324516732456173245671324567125436721543672514367254136725431672543617254361265347216534726153472651347265314726534172653412435761234567127364521736452713645273164527361452736415273641275463125764321576432517643257164325761432576413257641235647124356712734651276453126543721654372615437265143726541372654317265431253476125367412356742135674231567423516742356174235671423567123654712534672153467251346725314672534167253461725346127453621745362714536274153627451362745316274531276543126573412437561275643124573612734562173456271345627314562734156273451627345125637412647531246735125437612354671243765412376542137654231765423716542376154237651423765123475612346571254736123547621354762315476235147623541762354716235471264735125463712674351256734125746312475632147563241756324715632475163247561324756127365412564371267543127465312476351234765213476523147652341765234716523476152347612345762134576231457623415762345176234571623457126354721635472613547263154726351472635417263541236754213675423167542361754236715423675142367512745631247536123574612637541236745125476312476532147653241765324716532476153247651324765125364712546731276435217643527164352761435276413527643152764312573461243657124635712376451237465213746523174652371465237416523746152374612634751264375123467521346752314675234167523461752346715234671263457216345726134572631457263415726345172634512753641274365126374512746352174635271463527416352746135274631527463126357412375461256347126537412365742136574231657423615742365174236571423657126435721643572614357264135726431572643517264351257634124637512364752136475231647523614752364175236471523647124563712673451247365123745612753462175346271534627513462753146275341627534127563421756342715634275163427561342756314275631245763214576324157632451763245716324576132457612743562174356271435627413562743156274351627435126753412763452176345271634527613452763145276341527634'
string2 = '12634571263475126354712635741265347126537412654371265473126453712645731267543216754326175432671543267514326754132675431267534126375421637542613754263175426371542637514263754126374512376452137645231764523716452376145237641523764512376541253674215367425136742531674253617425367142536741253647123654721365472316547236154723651472365417236547123657412576342157634251763425716342576134257631425763412576431264357126437512647351246735214673524167352461735246713524673152467351246753126475321647532614753264175326471532647513264753126745321674532617453267145326741532674513267453126743512476352147635241763524716352476135247631524763512476531254673215467325146732541673254617325467132546731254637124563721456372415637245163724561372456317245637124365712465372146537241653724615372465137246531724653712465731265743216574326157432651743265714326574132657431265734125673421567342516734256173425671342567314256734125674312547632154763251476325417632547163254761325476312547361245736214573624157362451736245713624573162457361245763124567312564732156473251647325614732564173256471325647312564371236457213645723164572361457236415723645172364571236475124367521436752413675243167524361752436715243675124376521437652413765243176524371652437615243765124375612435762143576241357624315762435176243571624357612435671234567213456723145672341567234516723456172345671235467213546723154672351467235416723546172354671235476123475621347562314756234175623471562347516234756123476512367452136745231674523617452367145236741523674512367541267354216735426173542671354267315426735142673541267345124736521473652417365247136524731652473615247365124735612475362147536241753624715362475136247531624753612475631257463215746325174632571463257416325746132574631257436123574621357462315746235174623571462357416235746123576412537642153764251376425317642537164253761425376412534671253476125436712543761253746123754621375462317546237154623751462375416237546123745621374562317456237145623741562374516237456123746512463752146375241637524613752463175246371524637512463571234657213465723146572341657234615723465172346571234576123467512375641257364215736425173642571364257316425736142573641257346124537621453762415376245137624531762453716245376124536712356472135647231564723516472356147235641723564712356741256374215637425163742561374256317425637142563741256347127453612745631274356127436512746351274653127543612754631275346127536412756341275643127354612735641273456127346512736451273654127643512764531276345127635412765341276543'
string3 = '1235647125463721546372514637254163725461372546317254637125467312673541276354217635427163542761354276315427635142763512763451267345216734526173452671345267314526734152673412653742165374261537426513742653174265371426537125364721536472513647253164725361472536417253647125367412675342167534261753426715342675134267531426753127645321764532716453276145327641532764513276451274635124736512734652173465271346527314652734165273461527346125673451265743512674531247653127465321746532714653274165327461532746513274651263745216374526137452631745263714526374152637461253764123456712346571243657214365724136572431657243615724365172436512743567124357612375461247536125473621547362514736254173625471362547316254731265473216547326154732651473265417326547132654712475631247635123467512347561243765123476512465371256347215634725163472561347256314725634172563412635471257634123674512764351267435216743526174352671435267413526743152674312576431257364127356421735642713564273156427351642735614273561257436215743625174362571436257413625743162574312765432176543271654327615432765143276541327654312765341267543126457321645732614573264157326451732645713264574126357421635742613574263157426351742635714263571243675126345712564372156437251643725614372564137256431725643127564321756432715643275164327561432756413275641275364217536427153642751364275316427536142753612374651237654127364512465731264537126534712456731245637127543612534762153476251347625314762534176253471625347612534671243567214356724135672431567243516724356172435612365741236547126543712753461257346215734625173462571346257314625734162573412657342165734261573426517342657134265731426573124675312463751263475216347526134752631475263417526347152634712563741273654217365427136542731654273615427365142736512457631245736126473521647352614735264173526471352647315264731237645127436521743652714365274136527431652743615274361257463127453671245376125437621543762514376254137625431762543716254371235746127354612734561247356214735624173562471356247315624735162473512647531254367124536721453672415367245136724531672453617245361243756214375624137562431756243715624375162437512643752164375261437526413752643175264371526437125647361254763127546321754632715463275146327541632754613275461253746215374625137462531746253714625374162537451263754123647512364571264357124635721463572416357246135724631572463517246351236754123567412354761235467127563412567431274563217456327145632741563274516327456132745612357641237564123745612467351234576'

string1 = '12657431256743215674325167432561743256714325674132567412453761253764123576421357642315764235176423571642357614235761267453127356412537461273546217354627135462731546273514627354162735412375642137564231756423715642375164237561423756126547312465732146573241657324615732465173246571324657124536712645372164537261453726415372645137264531726453126735412573641243675123645712473561246537125743612754362175436271543627514362754136275431627543125647312763541276534217653427165342761534276513427653142765312467532146753241675324617532467153246751324675126457312456732145673241567324516732456173245671324567125436721543672514367254136725431672543617254361265347216534726153472651347265314726534172653412435761234567127364521736452713645273164527361452736415273641275463125764321576432517643257164325761432576413257641235647124356712734651276453126543721654372615437265143726541372654317265431253476125367412356742135674231567423516742356174235671423567123654712534672153467251346725314672534167253461725346127453621745362714536274153627451362745316274531276543126573412437561275643124573612734562173456271345627314562734156273451627345125637412647531246735125437612354671243765412376542137654231765423716542376154237651423765123475612346571254736123547621354762315476235147623541762354716235471264735125463712674351256734125746312475632147563241756324715632475163247561324756127365412564371267543127465312476351234765213476523147652341765234716523476152347612345762134576231457623415762345176234571623457126354721635472613547263154726351472635417263541236754213675423167542361754236715423675142367512745631247536123574612637541236745125476312476532147653241765324716532476153247651324765125364712546731276435217643527164352761435276413527643152764312573461243657124635712376451237465213746523174652371465237416523746152374612634751264375123467521346752314675234167523461752346715234671263457216345726134572631457263415726345172634512753641274365126374512746352174635271463527416352746135274631527463126357412375461256347126537412365742136574231657423615742365174236571423657126435721643572614357264135726431572643517264351257634124637512364752136475231647523614752364175236471523647124563712673451247365123745612753462175346271534627513462753146275341627534127563421756342715634275163427561342756314275631245763214576324157632451763245716324576132457612743562174356271435627413562743156274351627435126753412763452176345271634527613452763145276341527634'
string2 = '1264537125463741256374215637425163742561374256317425637142563712473652147365241736524713652473165247361524736412576431243657124675361247536214753624175362471536247513624753162475312647532164753261475326417532647153264751326475126473512467352146735241673524617352467135246731524673125467321546732514673254167325461732546713254671235476124635712465372146537241653724615372465137246531724653712465731265743216574326157432651743265714326574132657431265734125673421567342516734256173425671342567314256734125643712374657123465721346572314657234165723461572346517234651263457126347512635471263574126534712653741265437126547312563471264357126437512537461235674127653412765431267543216754326175432671543267514326754132675412547361245736214573624157362451736245713624573162457312564731256743124567351247635214763524176352471635247613524763152476312547632154763251476325417632547163254761325476125734612365741275436127546312753461275364127563412756431237546213754623175462371546237514623754162375412637542163754261375426317542637154263751426375124637521463752416375246137524631752463715246371245637214563724156372451637245613724563172456312574631257436123457612347562134756231475623417562347156234751623475612347651237654126735421673542617354267135426731542673514267354126743512453671235467213546723154672351467235416723546172354612543675124367521436752413675243167524361752436715243671254376125346712534761235746213574623157462351746235714623574162357463215746325174632571463257416325746132574612357645123764521376452317645237164523761452376415237641253764215376425137642531764253716425376142537612453762145376241537624513762453176245371624537126457312675341263745127346512735641273546123467512364751243765214376524137652431765243716524376152437651243756124357621435762413576243157624351762435716243576124356712345672134567231456723415672345167234561723456127345612374562137456231745623714562374156237451623745312673451273645712364572136457231645723614572364157236451723645127365412746351274653127643512764531276345127635412745361274563127435612743651247356124765312674532167453261745326714532674153267451326745123674521367452316745236174523671452367415236741253674215367425136742531674253617425367142536712536471236547213654723165472361547236514723654172365471236754612375647321564732516473256147325641732564713256471235647213564723156472351647235614723564172356412573642157364251736425713642573164257361425736124576341257634215763425176342571634257613425763142576351247563'
string3 = '1235647125463721546372514637254163725461372546317254637125467312673541276354217635427163542761354276315427635142763512763451267345216734526173452671345267314526734152673412653742165374261537426513742653174265371426537125364721536472513647253164725361472536417253647125367412675342167534261753426715342675134267531426753127645321764532716453276145327641532764513276451274635124736512734652173465271346527314652734165273461527346125673451265743512674531247653127465321746532714653274165327461532746513274651263745216374526137452631745263714526374152637461253764123456712346571243657214365724136572431657243615724365172436512743567124357612375461247536125473621547362514736254173625471362547316254731265473216547326154732651473265417326547132654712475631247635123467512347561243765123476512465371256347215634725163472561347256314725634172563412635471257634123674512764351267435216743526174352671435267413526743152674312576431257364127356421735642713564273156427351642735614273561257436215743625174362571436257413625743162574312765432176543271654327615432765143276541327654312765341267543126457321645732614573264157326451732645713264574126357421635742613574263157426351742635714263571243675126345712564372156437251643725614372564137256431725643127564321756432715643275164327561432756413275641275364217536427153642751364275316427536142753612374651237654127364512465731264537126534712456731245637127543612534762153476251347625314762534176253471625347612534671243567214356724135672431567243516724356172435612365741236547126543712753461257346215734625173462571346257314625734162573412657342165734261573426517342657134265731426573124675312463751263475216347526134752631475263417526347152634712563741273654217365427136542731654273615427365142736512457631245736126473521647352614735264173526471352647315264731237645127436521743652714365274136527431652743615274361257463127453671245376125437621543762514376254137625431762543716254371235746127354612734561247356214735624173562471356247315624735162473512647531254367124536721453672415367245136724531672453617245361243756214375624137562431756243715624375162437512643752164375261437526413752643175264371526437125647361254763127546321754632715463275146327541632754613275461253746215374625137462531746253714625374162537451263754123647512364571264357124635721463572416357246135724631572463517246351236754123567412354761235467127563412567431274563217456327145632741563274516327456132745612357641237564123745612467351234576'

string1 = '12736542536714253671265743125674321567432516743256174325671432567413256741245376125376412357642135764231576423517642357164235761423576126745312735641253746127354621735462713546273154627351462735416273541237564213756423175642371564237516423756142375612654731246573214657324165732461573246517324657132465712453671264537216453726145372641537264513726453172645312673541257364124367512364571247356124653712574361275436217543627154362751436275413627543162754312564731276354127653421765342716534276153427651342765314276531246753214675324167532461753246715324675132467512645731245673214567324156732451673245617324567132456712543672154367251436725413672543167254361725436126534721653472615347265134726531472653417265341243576123456712736452173645271364527316452736145273641527364127546312576432157643251764325716432576143257641325764123564712435671273465127645312654372165437261543726514372654137265431726543125347612347652134765231476523417652347165234761523476123457621345762314576234157623451762345716234571263547216354726135472631547263514726354172635412367542136754231675423617542367154236751423675127456312475361235746126375412367451254763125367412356742135674231567423516742356174235671423567123654712534672153467251346725314672534167253461725346127453621745362714536274153627451362745316274531276543126573412437561275643124573612734562173456271345627314562734156273451627345125637412647531246735125437612354671243765412376542137654231765423716542376154237651423765123475612346571254736123547621354762315476235147623541762354716235471264735125463712674351256734125746312475632147563241756324715632475163247561324756125643712675431274653124763512476532147653241765324716532476153247651324765125364712546731276435217643527164352761435276413527643152764312573461243657124635712376451237465213746523174652371465237416523746152374612634751264375123467521346752314675234167523461752346715234671263457216345726134572631457263415726345172634512753641274365126374512746352174635271463527416352746135274631527463126357412375461256347126537412365742136574231657423615742365174236571423657126435721643572614357264135726431572643517264351257634124637512364752136475231647523614752364175236471523647124563712673451247365123745612753462175346271534627513462753146275341627534127563421756342715634275163427561342756314275631245763214576324157632451763245716324576132457612743562174356271435627413562743156274351627435126753412763452176345271634527613452763145276341527634'
string2 = '12576431276345127635412653741265734125674312654731256437126543712643576214357624135762431576243517624357162435712634751263745123674521367452316745236174523671452367415236741253674215367425136742531674253617425361245736214573624157362451736245713624573162457312635741267534126735421673542617354267135426731542673514267351246753612475631265743126754321675432617543267154326751432675413267546123756412356741265347126354712634571236457213645723164572361457236415723645172364512736457123456721345672314567234156723451672345617234561273465712346751246735214673524167352461735246713524673152467312543765124376521437652413765243176524371652437615243761257346127536412573642157364251736425713642573164257361425736124576312547364125376421537642513764253176425371642537614253761245673125463712465371243657123465721346572314657234165723461572346517234651243756124536751243675214367524136752431675243617524367152436712543671234576123745621374562317456237145623741562374516237453126475321647532614753264175326471532647513264751247635214763524176352471635247613524763152476341257634215763425176342571634257613425763142576312574632157463251746325714632574163257461325746123576412567342156734251673425617342567134256731425673127643512764531275463127543612743561247365214736524173652471365247316524736152473612357462135746231574623517462357146235741623574125364731254673215467325146732541673254617325467132546712354672135467231546723514672354167235461723546123754621375462317546237154623751462375416237541263754216375426137542631754263715426375142637512476531267453216745326174532671453267415326745132674512376452137645231764523716452376145237641523764125346712534761234765123647512734561237465127354612376547123657432165743261574326517432657143265741326574125634712365472136547231654723615472365147236541723654127653412765431267435612743651247356123475621347562314756234175623471562347516234751264735412673451236754125637421563742516374256137425631742563714256371245637214563724156372451637245613724563172456312736541235476124537621453762415376245137624531762453716245371264573127453612745631274635127465372146537241653724615372465137246531724653127563412753461243576124356712463571264375124637521463752416375246137524631752463715246374125647321564732516473256147325641732564713256471235647213564723156472351647235614723564172356412735641275643125374631254763215476325147632541763254716325476132547612574361247536214753624175362471536247513624753162475312645371246573'
string3 = '1235647125463721546372514637254163725461372546317254637125467312673541276354217635427163542761354276315427635142763512763451267345216734526173452671345267314526734152673412653742165374261537426513742653174265371426537125364721536472513647253164725361472536417253647125367412675342167534261753426715342675134267531426753127645321764532716453276145327641532764513276451274635124736512734652173465271346527314652734165273461527346125673451265743512674531247653127465321746532714653274165327461532746513274651263745216374526137452631745263714526374152637461253764123456712346571243657214365724136572431657243615724365172436512743567124357612375461247536125473621547362514736254173625471362547316254731265473216547326154732651473265417326547132654712475631247635123467512347561243765123476512465371256347215634725163472561347256314725634172563412635471257634123674512764351267435216743526174352671435267413526743152674312576431257364127356421735642713564273156427351642735614273561257436215743625174362571436257413625743162574312765432176543271654327615432765143276541327654312765341267543126457321645732614573264157326451732645713264574126357421635742613574263157426351742635714263571243675126345712564372156437251643725614372564137256431725643127564321756432715643275164327561432756413275641275364217536427153642751364275316427536142753612374651237654127364512465731264537126534712456731245637127543612534762153476251347625314762534176253471625347612534671243567214356724135672431567243516724356172435612365741236547126543712753461257346215734625173462571346257314625734162573412657342165734261573426517342657134265731426573124675312463751263475216347526134752631475263417526347152634712563741273654217365427136542731654273615427365142736512457631245736126473521647352614735264173526471352647315264731237645127436521743652714365274136527431652743615274361257463127453671245376125437621543762514376254137625431762543716254371235746127354612734561247356214735624173562471356247315624735162473512647531254367124536721453672415367245136724531672453617245361243756214375624137562431756243715624375162437512643752164375261437526413752643175264371526437125647361254763127546321754632715463275146327541632754613275461253746215374625137462531746253714625374162537451263754123647512364571264357124635721463572416357246135724631572463517246351236754123567412354761235467127563412567431274563217456327145632741563274516327456132745612357641237564123745612467351234576'

string1 = '124376541237645123745612435761273546217354627135462731546273514627354162735412376542137654231765423716542376154237651423765123746521374652317465237146523741652374615237461253647125734612674351264573124657321465732416573246157324651732465713246571267354124537612547631254673124567321456732415673245167324561732456713245671423567142536714251243675123645712456371253476123547621354762315476235147623541762354716235471265374124365712463751236475213647523164752361475236417523647152364712635741236574213657423165742361574236517423657142365712543672154367251436725413672543167254361725436127435621743562714356274135627431562743516274351235467124536712645372164537261453726415372645137264531726453126745312467532146753241675324617532467153246751324675123465712643572164357261435726413572643157264351726435126754312657431256374125736412547361275436217543627154362751436275413627543162754312574631257643215764325176432571643257614325764132576412357642135764231576423517642357164235761423576123475612734562173456271345627314562734156273451627345126753412763452176345271634527613452763145276341527634125463712365471253746124735612467351247653214765324176532471653247615324765132476512347652134765231476523417652347165234761523476125643712435671257634126734512647531246537124635712534672153467251346725314672534167253461725346127356412734651274563124573612653472165347261534726513472653147265341726534126375412367542136754231675423617542367154236751423675125634712654731274653124763512473651263745124375612345762134576231457623415762345176234571623457126345721634572613457263145726341572634517263451276435217643527164352761435276413527643152764312567341253674123564712635472163547261354726315472635147263541726354127653421765342716534276153427651342765314276531245763214576324157632451763245716324576132457612345671273645217364527136452731645273614527364152736412537641237564213756423175642371564237516423756142375612647351265734127563421756342715634275163427561342756314275631247563214756324175632471563247516324756132475612367451274635217463527146352741635274613527463152746312765431256743215674325167432561743256714325674132567412356742135674231567423516742356174235612753641275643125743612754631247536123574612745362174536271453627415362745136274531627453127635412743651265437216543726154372651437265413726543172654312564731276453126347512643751234675213467523146752341675234617523467152346712543761273654123754612753462175346271534627513462753146275341627534'
string3 = '12356471253674126753421675342617534267153426751342675314267531276453217645327164532761453276415327645132764512746351247365127346521734652713465273146527341652734615273461256734512657431247635126745312476531274653217465327146532741653274615327465132746512637452163745261374526317452637145263741526374612537641234567123465712436572143657241365724316572436157243651724365127435671243576123754612475361254736215473625147362541736254713625473162547312654732165473261547326514732654173265471326547125463721546372514637254163725461372546317254637125467312673541276354217635427163542761354276315427635142763512763451267345216734526173452671345267314526734152673412653742165374261537426513742653174265371426537125364721536472513647253164725361472536417253641247563123467512347561243765123476512465371256347215634725163472561347256314725634172563412576341263547123674512764351267435216743526174352671435267413526743152674312576431257364127356421735642713564273156427351642735614273561257436215743625174362571436257413625743162574312765432176543271654327615432765143276541327654312765341267543126457321645732614573264157326451732645713264574126357421635742613574263157426351742635714263571243675126345712564372156437251643725614372564137256431725643127564321756432715643275164327561432756413275641275364217536427153642751364275316427536142753612374651237654127364512465731264537126534712456731245637127543612534762153476251347625314762534176253471625347612534671243567214356724135672431567243516724356172435612365741236547126543712753461257346215734625173462571346257314625734162573412657342165734261573426517342657134265731426573124675312463751263475216347526134752631475263417526347152634712563741273654217365427136542731654273615427365142736512457631245736126473521647352614735264173526471352647315264731237645127436521743652714365274136527431652743615274361257463127453671245376125437621543762514376254137625431762543716254371235746127354612734561247356214735624173562471356247315624735162473512647531254367124536721453672415367245136724531672453617245361243756214375624137562431756243715624375162437512643752164375261437526413752643175264371526437125647361254763127546321754632715463275146327541632754613275461253746215374625137462531746253714625374162537451263754123647512364571264357124635721463572416357246135724631572463517246351236754123567412354761235467127563412567431274563217456327145632741563274516327456132745612357641237564123745612467351234576'

string1 = '12456371265437216543726154372651437265413726543172654312653472165347261534726513472653147265341726534127645312765342176534271653427615342765134276531427653124567321456732415673245167324561732456713245671274635217463527146352741635274613527463152746312546731264357216435726143572641357264315726435172643512634751264753125634712653741267453126735412367451267543127654312567341257643215764325176432571643257614325764132576412534761243576127465312475361246537124573612745362174536271453627415362745136274531627453124673512476532147653241765324716532476153247651324765125437612345671275364127563421756342715634275163427561342756314275631247635124736512654731253674123657421365742316574236157423651742365714236571243657124376542137654231765423716542376154237651423765123746521374652317465237146523741652374615237461234756123476521347652314765234176523471652347615234761263754123765412376451237546126457312457632145763241576324517632457163245761324576123457621345762314576234157623451762345716234571263745127435621743562714356274135627431562743516274351267534124675321467532416753246175324671532467513246751267345124735612453671425367141274365123647521364752316475236147523641752364715236471257463125734612763541257436127543621754362715436275143627541362754316275431256743215674325167432561743256714325674132567412357642135764231576423517642357164235761423576127365412367542136754231675423617542367154236751423675124367512537461273546217354627135462731546273514627354162735412576341275643127345621734562713456273145627341562734516273451267435124637512647351237564213756423175642371564237516423756142375612753462175346271534627513462753146275341627534126574312563741245376126354721635472613547263154726351472635417263541274563125473612346571236457126345721634572613457263145726341572634517263451253647127546312763452176345271634527613452763145276341527634125436721543672514367254136725431672543617254361235467127643521764352716435276143527641352764315276431265734124375612356742135674231567423516742356174235671423567125736412537641235746127346512735641256437126357412356471253467215346725134672531467253416725346172534612736452173645271364527316452736145273641527364125476312475632147563241756324715632475163247561324756123547621354762315476235147623541762354716235471237456124356712645372164537261453726415372645137264531726453125647312465732146573241657324615732465173246571324657126437512346752134675231467523416752346175234671523467123654712463571254637'
string2 = '1237654712364572136457231645723614572364157236451723645127365412743651247536214753624175362471536247513624753162475312643751246753126547312564732156473251647325614732564173256471325647123564721356472315647235164723561472356417235641275643126754321675432617543267154326751432675413267541256347123657412536742153674251367425316742536174253612473561274356127456312763451276354126374512367546123567412563742156374251637425613742563174256371425637124563721456372415637245163724561372456317245631257436124756312754631275436127563412745361274635127465312753641257364215736425173642571364257316425736142573612457631254673215467325146732541673254617325467132546712354672135467231546723514672354167235461723546123576412735461237564127356412734561273465124736521473652417365247136524731652473615247361267345123764521376452317645237164523761452376415237641257634215763425176342571634257613425763142576312346751236745213674523167452361745236714523674152367412536473125674312653471265743216574326157432651743265714326574132657412653741265734125673421567342516734256173425671342567314256731234756213475623147562341756234715623475162347512634571253764215376425137642531764253716425376142537612453671263547126357412634751243765124375612476531264735412673542167354261735426713542673154267351426735124637521463752416375246137524631752463715246374125643712643571264537124653721465372416537246153724651372465317246531264753216475326147532641753264715326475132647512436752143675241367524316752436175243671524367125436712543765214376524137652431765243716524376152437612573461275346123754621375462317546237154623751462375416237541263754216375426137542631754263715426375142637512435762143576241357624315762435176243571624357127643512764531267435124673521467352416735246173524671352467315246731254637123456721345672314567234156723451672345617234561237465124763521476352417635247163524761352476315247631254736125764312537461253467125347612453762145376241537624513762453176245371624537126457312654371245673125746321574632517463257146325741632574613257461235746213574623157462351746235714623574162357412435671234576124365712346572134657231465723416572346157234651723465123476512354761237456213745623174562371456237415623745162374512736457123647512463576124657312674532167453261745326714532674153267451326745123654721365472316547236154723651472365417236541276534126753412765431254763215476325147632541763254716325476132547612457362145736241573624517362457136245731624573'
string3 = '1234576123547612357461243756214375624137562431756243715624375162437512634752163475261347526314752634175263471526347125376412375461273564217356427135642731564273516427356142735612765432176543271654327615432765143276541327654127354612754632175463271546327514632754163275461327546125437621543762514376254137625431762543716254371235467124537612547631246753127645321764532716453276145327641532764513276451263754127364512374561253476125346712435761254367124563712546731247653127453672145367241536724513672453167245361724536124753612574362157436251743625714362574136257431625743126735412763542176354271635427613542763154276351427635127436521743652714365274136527431652743615274361257364127534612573462157346251734625713462573146257341625734126745312476351276345127643512637451263457124536712435672143567241356724315672435167243561724356124735621473562417356247135624731562473516247351264753127465321746532714653274165327461532746513274651234567123564712536741275364217536427153642751364275316427536142753612734561243765127346521734652713465273146527341652734615273461253746215374625137462531746253714625374162537412356741273654217365427136542731654273615427365142736512475631274563217456327145632741563274516327456132745612365471256437215643725164372561437256413725643172564312576431275436125746371254637215463725146372541637254613725463172546312645732164573261457326415732645173264571326457126754312675342167534261753426715342675134267531426753124635721463572416357246135724631572463517246351264735216473526147352641735264713526473152647312456731245763124573612547362154736251473625417362547136254731625473126543712654732165473261547326514732654173265471326547123476512347561243657214365724136572431657243615724365172436512743567124367512346751264357124657312465371256473126537421653742615374265137426531742653714265371236457124637512364751236574123675412367451267345216734526173452671345267314526734152673412357641237654312756432175643271564327516432756143275641327564123746512376451274635126437521643752614375264137526431752643715264371256734126573421657342615734265173426571342657314265731264537125364721536472513647253164725361472536417253641276534126357421635742613574263157426351742635714263571247365124673512674352167435261743526714352674135267431526743125674312657431275634125763412375641234657126534762153476251347625314762534176253471625347125637452163745261374526317452637145263741526374126354712563472156347251634725613472563147256341725634'

string1 = '124563712654372165437261543726514372654137265431726543126534721653472615347265134726531472653417265341276453127653421765342716534276153427651342765314276531245673214567324156732451673245617324567132456712746352174635271463527416352746135274631527463125467312643572164357261435726413572643157264351726435126347512647531256347126537412674531267354123674512675431276543125673412576432157643251764325716432576143257641325764125347612435761274653124753612465371245736127453621745362714536274153627451362745316274531246735124765321476532417653247165324761532476513247651254376123456712753641275634217563427156342751634275613427563142756312476351247365126547312536741236574213657423165742361574236517423657142365712436571243765421376542317654237165423761542376514237651237465213746523174652371465237416523746152374612347561234765213476523147652341765234716523476152347612637541237654123764512375461264573124576321457632415763245176324571632457613245761234576213457623145762341576234517623457162345712637451274356217435627143562741356274315627435162743512675341246753214675324167532461753246715324675132467512673451247356124536714253671274365123647521364752316475236147523641752364715236471257463125734612763541257436127543621754362715436275143627541362754316275431256743215674325167432561743256714325674132567412357642135764231576423517642357164235761423576127365412367542136754231675423617542367154236751423675124367512537461273546217354627135462731546273514627354162735412576341275643127345621734562713456273145627341562734516273451267435124637512647351237564213756423175642371564237516423756142375612753462175346271534627513462753146275341627534126574312563741245376126354721635472613547263154726351472635417263541274563125473612346571236457126345721634572613457263145726341572634517263451253647127546312763452176345271634527613452763145276341527634125436721543672514367254136725431672543617254361235467127643521764352716435276143527641352764315276431265734124375612356742135674231567423516742356174235671423567125736412537641235746127346512735641256437126357412356471253467215346725134672531467253416725346172534612736452173645271364527316452736145273641527364125476312475632147563241756324715632475163247561324756123547621354762315476235147623541762354716235471237456124356712645372164537261453726415372645137264531726453125647312465732146573241657324615732465173246571324657126437512346752134675231467523416752346175234671523467123654712463571254637'
string2 = '25367141237654712364572136457231645723614572364157236451723645127365412743651247536214753624175362471536247513624753162475312643751246753126547312564732156473251647325614732564173256471325647123564721356472315647235164723561472356417235641275643126754321675432617543267154326751432675413267541256347123657412536742153674251367425316742536174253612473561274356127456312763451276354126374512367546123567412563742156374251637425613742563174256371425637124563721456372415637245163724561372456317245631257436124756312754631275436127563412745361274635127465312753641257364215736425173642571364257316425736142573612457631254673215467325146732541673254617325467132546712354672135467231546723514672354167235461723546123576412735461237564127356412734561273465124736521473652417365247136524731652473615247361267345123764521376452317645237164523761452376415237641257634215763425176342571634257613425763142576312346751236745213674523167452361745236714523674152367412536473125674312653471265743216574326157432651743265714326574132657412653741265734125673421567342516734256173425671342567314256731234756213475623147562341756234715623475162347512634571253764215376425137642531764253716425376142537612453671263547126357412634751243765124375612476531264735412673542167354261735426713542673154267351426735124637521463752416375246137524631752463715246374125643712643571264537124653721465372416537246153724651372465317246531264753216475326147532641753264715326475132647512436752143675241367524316752436175243671524367125436712543765214376524137652431765243716524376152437612573461275346123754621375462317546237154623751462375416237541263754216375426137542631754263715426375142637512435762143576241357624315762435176243571624357127643512764531267435124673521467352416735246173524671352467315246731254637123456721345672314567234156723451672345617234561237465124763521476352417635247163524761352476315247631254736125764312537461253467125347612453762145376241537624513762453176245371624537126457312654371245673125746321574632517463257146325741632574613257461235746213574623157462351746235714623574162357412435671234576124365712346572134657231465723416572346157234651723465123476512354761237456213745623174562371456237415623745162374512736457123647512463576124657312674532167453261745326714532674153267451326745123654721365472316547236154723651472365417236541276534126753412765431254763215476325147632541763254716325476132547612457362145736241573624517362457136245731624573'


string1 = '124563712654372165437261543726514372654137265431726543126534721653472615347265134726531472653417265341276453127653421765342716534276153427651342765314276531245673214567324156732451673245617324567132456712746352174635271463527416352746135274631527463125467312643572164357261435726413572643157264351726435126347512647531256347126537412674531267354123674512675431276543125673412576432157643251764325716432576143257641325764125347612435761274653124753612465371245736127453621745362714536274153627451362745316274531246735124765321476532417653247165324761532476513247651254376123456712753641275634217563427156342751634275613427563142756312476351247365126547312536741236574213657423165742361574236517423657142365712436571243765421376542317654237165423761542376514237651237465213746523174652371465237416523746152374612347561234765213476523147652341765234716523476152347612637541237654123764512375461264573124576321457632415763245176324571632457613245761234576213457623145762341576234517623457162345712637451274356217435627143562741356274315627435162743512675341246753214675324167532461753246715324675132467512673451247356124536714253671274365123647521364752316475236147523641752364715236471257463125734612763541257436127543621754362715436275143627541362754316275431256743215674325167432561743256714325674132567412357642135764231576423517642357164235761423576127365412367542136754231675423617542367154236751423675124367512537461273546217354627135462731546273514627354162735412576341275643127345621734562713456273145627341562734516273451267435124637512647351237564213756423175642371564237516423756142375612753462175346271534627513462753146275341627534126574312563741245376126354721635472613547263154726351472635417263541274563125473612346571236457126345721634572613457263145726341572634517263451253647127546312763452176345271634527613452763145276341527634125436721543672514367254136725431672543617254361235467127643521764352716435276143527641352764315276431265734124375612356742135674231567423516742356174235671423567125736412537641235746127346512735641256437126357412356471253467215346725134672531467253416725346172534612736452173645271364527316452736145273641527364125476312475632147563241756324715632475163247561324756123547621354762315476235147623541762354716235471237456124356712645372164537261453726415372645137264531726453125647312465732146573241657324615732465173246571324657126437512346752134675231467523416752346175234671523467123654712463571254637'
string2 = '12376547123645721364572316457236145723641572364517236451273654127436512475362147536241753624715362475136247531624753126437512467531265473125647321564732516473256147325641732564713256471235647213564723156472351647235614723564172356412756431267543216754326175432671543267514326754132675412563471236574125367421536742513674253167425361742536714123467512367452136745231674523617452367145236741523674125364731256743126534712657432165743261574326517432657143265741326574126537412657341256734215673425167342561734256713425673142567312347562134756231475623417562347156234751623475126345712537642153764251376425317642537164253761425376124536712635471263574126347512437651243756124765312647354126735421673542617354267135426731542673514267351246375214637524163752461375246317524637152463741256437126435712645371246537214653724165372461537246513724653172465361247356127435612745631276345127635412637451236754612356741256374215637425163742561374256317425637142563712456372145637241563724516372456137245631724563125743612475631275463127543612756341274536127463512746531275364125736421573642517364257136425731642573614257361245763125467321546732514673254167325461732546713254671235467213546723154672351467235416723546172354612357641273546123756412735641273456127346512473652147365241736524713652473165247361524736126734512376452137645231764523716452376145237641523764125763421576342517634257163425761342576314257631264753216475326147532641753264715326475132647512436752143675241367524316752436175243671524367125436712543765214376524137652431765243716524376152437612573461275346123754621375462317546237154623751462375416237541263754216375426137542631754263715426375142637512435762143576241357624315762435176243571624357127643512764531267435124673521467352416735246173524671352467315246731254637123456721345672314567234156723451672345617234561237465124763521476352417635247163524761352476315247631254736125764312537461253467125347612453762145376241537624513762453176245371624537126457312654371245673125746321574632517463257146325741632574613257461235746213574623157462351746235714623574162357412435671234576124365712346572134657231465723416572346157234651723465123476512354761237456213745623174562371456237415623745162374512736457123647512463576124657312674532167453261745326714532674153267451326745123654721365472316547236154723651472365417236541276534126753412765431254763215476325147632541763254716325476132547612457362145736241573624517362457136245731624573'
string3 = '1234576123547612357461243756214375624137562431756243715624375162437512634752163475261347526314752634175263471526347125376412375461273564217356427135642731564273516427356142735612765432176543271654327615432765143276541327654127354612754632175463271546327514632754163275461327546125437621543762514376254137625431762543716254371235467124537612547631246753127645321764532716453276145327641532764513276451263754127364512374561253476125346712435761254367124563712546731247653127453672145367241536724513672453167245361724536124753612574362157436251743625714362574136257431625743126735412763542176354271635427613542763154276351427635127436521743652714365274136527431652743615274361257364127534612573462157346251734625713462573146257341625734126745312476351276345127643512637451263457124536712435672143567241356724315672435167243561724356124735621473562417356247135624731562473516247351264753127465321746532714653274165327461532746513274651234567123564712536741275364217536427153642751364275316427536142753612734561243765127346521734652713465273146527341652734615273461253746215374625137462531746253714625374162537412356741273654217365427136542731654273615427365142736512475631274563217456327145632741563274516327456132745612365471256437215643725164372561437256413725643172564312576431275436125746371254637215463725146372541637254613725463172546312645732164573261457326415732645173264571326457126754312675342167534261753426715342675134267531426753124635721463572416357246135724631572463517246351264735216473526147352641735264713526473152647312456731245763124573612547362154736251473625417362547136254731625473126543712654732165473261547326514732654173265471326547123476512347561243657214365724136572431657243615724365172436512743567124367512346751264357124657312465371256473126537421653742615374265137426531742653714265371236457124637512364751236574123675412367451267345216734526173452671345267314526734152673412357641237654312756432175643271564327516432756143275641327564123746512376451274635126437521643752614375264137526431752643715264371256734126573421657342615734265173426571342657314265731264537125364721536472513647253164725361472536417253641247365127653412635742163574261357426315742635174263571426357124673512674352167435261743526714352674135267431526743125674312657431275634125763412375641234657126534762153476251347625314762534176253471625347125637452163745261374526317452637145263741526374126354712563472156347251634725613472563147256341725634'

# export_string_map(7, string1, [string2, string3], filename="string1map.txt")

#wildcards
# string1 = '12476351247653214765324176532471653247615324765132476512374652137465231746523714652374165237461523746127653421765342716534276153427651342765314276531247365127346512736541236475213647523164752361475236417523647152364712567432156743251674325617432567143256741325674123576421357642315764235176423571642357614235761273546217354627135462731546273514627354162735412475361243675124375612456371236547125463712763452176345271634527613452763145276341527634127563421756342715634275163427561342756314275631247563214756324175632471563247516324756132475612347561245376123645712643572164357261435726413572643157264351726435124356712756431275364127465312536471257463125647312453671*253674125473612754362175436271543627514362754136275431627543127635412743651267534126745312647531256374126347512673451267543127654312465732146573241657324615732465173246571324657125346721534672513467253146725341672534617253461273564123567421356742315674235167423561742356714235671275346217534627153462751346275314627534162753412764352176435271643527614352764135276431527643127435621743562714356274135627431562743516274351267435126374512367451265347216534726153472651347265314726534172653412745631256734125467312563471263574125476312657341274635217463527146352741635274613527463152746312346752134675231467523416752346175234671523467126547312645731247356124376542137654231765423716542376154237651*23765412376451237456123675421367542316754236175423671542367514236751234765213476523147652341765234716523476152347612435761257346124573612745362174536271453627415362745136274531627453125347612543672154367251436725413672543167254361725436124653712463571273456217345627134562731456273415627345162734512657431273645217364527136452731645273614527364152736412543761235467124673512754631257364125743612673541235476213547623154762351476235417623547162354712456732145673241567324516732456173245671324567126543721654372615437265143726541372654317265431264375126473512576341257643215764325176432571643257614325764132576412537641235746123564712653741236574213657423165742361574236517423657142365712436571263754124637512375642137564231756423715642375164237561423756123456712635472163547261354726315472635147263541726354125643712346571237546125374612457632145763241576324517632457163245761324576123457621345762314576234157623451762345716234571263457216345726134572631457263415726345172634512645372164537261453726415372645137264531726453127645312467532146753241675324617532467153246751324675'
# string2 = '124365712346572134657231465723416572346157234651723465124567312647354126735421673542617354267135426731542673514267351246735214673524167352461735246713524673152467312546732154673251467325416732546173254671325467123546721354672315467235146723541672354617235461246357612435671234567213456723145672341567234516723456172345612374562137456231745623714562374156237451623745126437512436752143675241367524316752436175243671524367125436712643571264537126457312654731256473215647325164732561473256417325647132564712356472135647231564723516472356147235641723564125437652143765241376524317652437165243761524376125734612753461247356127435612763451276354127356412735461267435127364512736541275364125736421573642517364257136425731642573614257361245736214573624157362451736245713624573162457312365472136547231654723615472365147236541723654712365741257634215763425176342571634257613425763142576312734561273465123476512375641276435127645312674532167453261745326714532674153267451326745123764521376452317645237164523761452376415237641253764215376425137642531764253716425376142537612453762145376241537624513762453176245371624537124653721465372416537246153724651372465317246536124756312574632157463251746325714632574163257461325746123574621357462315746235174623571462357416235743261574326517432657143265741*26574321657432127453612746351274653127543612756341274563127546312756431267543216754326175432671543267514326754132675412765341267534127654312564371267345124376512437561243576214357624135762431576243517624357162435712534671253476127436512476352147635241763524716352476135247631524763125476321547632514763254176325471632547613254761235476123467512357641256347125473612574361235674126537412657341256734215673425167342561734256713425673142567312634751263457124657312576431253746125364731256743126534712654371236457213645723164572361457236415723645172364571236475124675312453671263547126357412637542163754261375426317542637154263751426375124637521463752416375246137524631752463715246374125637421563742516374256137425631742563714256371245637214563724156372451637245613724563172456312374651247365214736524173652471365247316524736152473612546371236754612375462137546231754623715462375146237541623754126374512367452136745231674523617452367145236741523674125367421536742513674253167425361742536714124576312476531234576123765412475362147536241753624715362475136247531624753126475321647532614753264175326471532647513264756231475623417562347156234751*23475621347562'
# string3 = '12345671236574123654712436751234675127563412576341263574216357426135742631574263517426357142635712463751236475123645712765341257364127536421753642715364275136427531642753614275367124536721453672415367245136724531672453617245361257436215743625174362571436257413625743162574312657431263457123465712435671243576123547612356471253674126354712564372156437251643725614372564137256431725643125764312753461257346215734625173462571346257314625734162573412657342165734261573426517342657134265731426573124657312645732164573261457326415732645173264571326457125634721563472516347256134725631472563417256341235764123765412736451276345126374521637452613745263174526371452637415263745126375412736542173654271365427316542736154273651427365124756312745632174563271456327415632745163274561327456124375621437562413756243175624371562437516243751264375216437526143752641375264317526437152643712567431254763124675312467351267435216743526174352671435267413526743152674312567341267534216753426175342671534267513426753142675312735642173564271356427315642735164273561427356124563712546731243765123457612347561243657214365724136572431657243615724365172436512743567214356724135672431567243516724356172435612473651273465217346527134652731465273416527346152734612537462153746251374625317462537146253741625374261537426513742653174265371*265374216537421246357214635724163572461357246315724635172463512765432176543271654327615432765143276541327654312756432175643271564327516432756143275641327564123756412347651263475216347526134752631475263417526347152634712536472153647251364725316472536147253641725364127543612734561264537123546712653476215347625134762531476253417625347162534712563741235674125436712453761254376215437625143762541376254317625437162543712564731247653127465321746532714653274165327461532746513274651274365217436527143652741365274316527436152743612574637125376412473562147356241735624713562473156247351624735126475312476351237645126734521673452617345267134526731452673415267341236754123674512746351267543126735412763542176354271635427613542763154276351427635127643512647352164735261473526417352647135264731526473124567312457631245736125473621547362514736254173625471362547316254731265437126547321654732615473265147326541732654713265471267453127645321764532716453276145327641532764513276451237546127354612745361247536125347612534671237465123745612357461264357124653712546372154637251463725416372546137254631725463271546327514632754163275461*27546321754632'

# words1 = get_unique_words_in_string(string1)
# words2 = get_unique_words_in_string(string2)
# words3 = get_unique_words_in_string(string3)

# 5040 - 120 = 4960; 4960/3 = 1640
# max words string 1
# 1677
# string1 = '1254367215436725143672541367254316725436172543621754362126475312467351247635124736512463751264735126734512674351267453126735412367542136754231675423617542367154236751423657142365174236512345671246357124365712437651273654123765421376542317654237165423761542376514237654123576421253647127346512736452173645271364527316452736145273641527364712563741264357216435726143572631457263126753412657341256437123654712654372165437261543726514372654137265431726543627154362751436275314627534162754316275413627541237456127345621734562713456274135627412356471253467215346725134672531467253416725346172534621753462715346275134627531234657123645712634572163457261345726413572641263574125734612763452176345271634527613452764135276412534761243576123457621257364125376412357461264573125367412354671264537216453726145372641537264513726453172643517263451726354172635147263512746352174635271463527416352746135274631527643152763415276314527631257436127543612476532147653241765324716532476127356412543761274356217435627143562731456273126375412453671425367125374612753462127436512374652137465231746523714652374165237461523476152346715234617523461256347126537412635472123764512375461256734125763412547631254736123475612347652134765231476523417652345716234576123547621354762315476235147623541762354716235472163547261354726315472634157263412756431276534217653427165342761534276513427653124756321267543127645312765431265743125674321567432516743256174325671432567413256742135674231567423615742361246753214675324167532461753246712754631274653124576321457632415763245176324571632457613245762134576231457623415762345176234571264375123467521346752314675234167523471652347127643521764352716435276143527653142765341276354127536412756342175634271563427516342756134275631427563214756324175632471563247615324765132475613247516324751243675124356712546371243756126374512634751265347216534726153472651347265314726534172653461273546217354627135462731546273514627354162734516273415627341274563125647312546731246573214657324165732461573246715324675132465713246517324651235674212465371245637126547312456732145673241567324516732456173245671324567412365742136574231657423516742351764235716423576142356714235617423561247356124537612375642137564231756423715642375164237561423756312475361245736127453621745362714536274153627451362745316274351627431562743125746312576432157643251764325716432576143257641325764213576423157642351726431572643123674512364752136475231647523614752364175236471523647'
# #  1610
# string2 = '3126754321675432617543267154326751432675413267546123745612374651253746123576412465731243576214357624135762431576243517624357162435761243675214367524136752431675243617524367152436741523671452367412563471235467213546723154672341567234125674312574632157463251746325714632574163257461325746213574623157462351746235714623574162357461237546213754623175462371546237514263752146375241637524613752463175246371524637412567342156734251673425617234651723456172354167235412476531274635127465312734561276435127645312756341276534126753412475362147536241753624517362457136245731627453127654312576342157634251763425713642573164257361425736214573624157362471536247123647512645371624537612453762145376241537624513762453176245371264573126547312564371257436126473512463751246357126435712635471263574126537425163742561374256317425637124576314257631524763152746312357462126734512534671253476124375612456371425673142567134256712543671257346127536412573642157364251736425713254673212736451273654127356412735467123547612657341243657123465721346572314657234165723451672345123765412564732156473251647325614732564173256471325647213564723156472351647235614723564172354617235647212456731254763215476325147632541245736124536712637456213745623174562371456237641523761452376412563742156372415637425136742531674253617425367142563721456372124735612743561273465123645721364572316457236145723641572364517236457123675416237451623475126347516237415623471562374126543712743651235647123456721345672314567235146723512467352124763521476352417635247163524731652473127543612763451243567123457612745361274563127546312753461237645213764523176452371645237514623754162735412653471264375412637542163754261375426317542637154263751423675127564312475631724563172645312365741263457126574321657432615743265174326571237564123475621347562314756234175623461572346152374612536471235674125367421536742513764253176425371642537614253765124736521473652417365247136524761352476125463712674351234675123476512437652143765241376524317652437124653712467531264753216475326147532641753264715326475136247513264753162475312674532167453261745326714532674153267451236745132674521367452316745236174523671254673125764312543761254736152473612537642153764251372465317246537214653724165372461537246513724561372451637245127635412673542167354261735426713542673154267351426735214673524167352461735246713524673152467321546732514673254167325461732546713254761325471632541763254712365472136547231654723615472365147236541723654'
# # 1646
# string2 = '3126547312564371254736152473612537641256374215637425163742561374256317425637142567314256713425671253476124375612476352147635241763524716352473165247312576342157634251763425617342561275643124756371246537214653724165372451637245613724563172465137246531724615372461523746125364712456731254376125467312574632157463251746325714632574163257461325746231574621357462123564721356472315647235164723561472356417235461723541672354124765312574361264735124673521235746123754621375462317546237154623761452376415237642153764251376425317642536174253612673456127643512764531234576124365712346572134657231465723416572346157234651723456172345167234512763541267354216735426173542671354267315426735142673521467352416735246173524671352467315246732514673215467321243567123456721345672314567235146723512573461236475126453712645731267543216754326175432671543267514326754132675461237465127463512746531273465123645721364572316457236145723641572364517236457123475621347562314756234175623471562347516234753162475136247512634751243675214367524136752431675243617524367152436741256347123546721354672315467234156723412567431245637214563724156372451236745212465736124536712543671257643125476321547632514763254176325461732541673254123756471235674125367421236574162357416273541265374126534712643754126743512346751234765124376521437652413765243176524371652437615243765124735612743561276345127654312745361274563127546312753641257364215736425173642571364257316425736142573621457362415736247153624712473652147365241736524713652476135247612546371245763142576134257631524763152746312435762143576241357624315762435176243571624537612453762145376241537624513762453176245371624573162457136245712654371274365124573621275634127653412675341247536214753624175362451736245123765412564732156473251647325614732564173256471325467132547613254716325471236547213654723165472361547236514723654172365125346712537461235764123764521376452317645237164523761425376142357612467531264753216475326147532641753264715326475132647531267453216745326174532671453267415326745132674521367452316745236174523671452367415236742153674251367425316742537164253712463751246357126435712635471263574126374512634571236754126375421637542613754263175426371542637514263752146375241637524613752463175246371524637412567342156734251673425716342571273456123745621374562317456237145623741562374516237541623751462357146235174623512753461275436127364512736541273564127354671235476126573412657432165743261574326517432657143265741326574'
# # 1649
# string2 = '312675432167543261754326715432675143267541326754612375462137546231754623715462376145237641523764215376425137642531764253617425361275364125736421573642517364257136425731642573614257631425761342576124573621457362415736247153624712437561247563712456731254673125734612743561274365126437512475362147536241753624517362451276354126735421673542617354267135426731542673514267352146735241673524617352467135246731524673251467321546732124357621435762413576243157624351762435716243576124367521436752413675243167524361752436715243674125634712473652147365241736524713652476135247612576342157634251763425617342561275436127534612756431247653123574612374562137456231745623714562374156237451623754162375146237512345761254376125364712356741253674212457631524763152746312754631254736152473612574361257463215746325174632571463257416325746132574621357462315746235174623571462357416273541265374126534712654371247635214763524176352471635247316524731276345127654312367541236457213645723164572361457236415723645172364571236475124365712346572134657231465723416572346157234651723456172345167234512367452126573412674351246375124635712643571263547126357412637542163754261375426317542637154263751426375412637451246753126475321647532614753264175326471532647513264753126745321674532617453267145326741532674513267452136745231674523617452367145236741523674215367425136742531674253716425371246537214653724165372451637245613724563172465137246531724615372461523746125376412563742156374251637425613742563174256371425673142567134256712345672134567231456723514672351246573612453762145376241537624513762453176245371624573162457136245712376541235647213564723156472351647235614723564172354617235416723541254637521463752416375246137524631752463715246374125673421567342516734257163425712736451273654127356412735467123547612734651264735124673521263457126453712645731265473125643712746351274536127456312746531276435127645312435671256473215647325164732561473256417325647132546713254761325471632547123654721365472316547236154723651472365417236512534671253746123576412673456127563412765341267534125764312547632154763251476325417632546173254167325412734561237465123546721354672315467234156723412567431236574162357462124563721456372415637245123764521376452317645237164523761425376124536712543671253476123756471234675123476512437652143765241376524317652437165243761524376512473561234756213475623147562341756234715623475162347531624751362475126347512657432165743261574326517432657143265741326574'
#
# # 1617
# string3 = '51276435127654321765432716543276154327651432765413276451327641532764127536412675431267534216753426175342671534267512376451256743125763412574631725463217546327154632751463275412736542173654271365427316542736154273651427356142735164273512347651237654126345712354761235746126375412765341274356172435672143567241356724315672435167243561274635172463517426357125346712736451236745123654712354671257364124567312453761254367124536721453672415367245136724531672453617245367124356712437651234756124375621437562413756243175624371562437516243752164375261437526413752643125743621273564217356427135642751364271536427127563412467351264735216473526147352641735264317526437152643721564372516437256143725641372564317256437125634712536472153647251364725316472536147253641725634721563472516347256134725631472563417253642175364212576431275346125734612537462153746251374625317462537146253761425736124563712546372154637251463725416372546137254631724563124756312745632174563271456327415632746153274651327456132745163274512637452163745261374526317452637145263741526734152674315267413526741247356214735624173562471356247315624735162475316427531641253764212457361254736215473625147362541736254713625473162547321654732615473265147326541732654312756432175643271564327516432754163275461327564132756143275612465371234675124365721436572413657243165724361572436517243652714365274136527431652743615274362157436251743652174365124736512743651276345123576412356741275463212745361247536142753612634752163475261347526314752634175263471526347612534762153476251347625314762534176253471625374162573416257431625741362574123647512364571243675126357421635742613574263157426351743625713462571436257314625731264753125367412657342165734261573426512734652173465271346527314652734165273461527346251734621573462123465712374651237456123675412546731256473152647312654731264573216457326145732641573264571326451732645126734521673452617345267134526751342675314265731426537142653174265312645371234576126543712653471256374124657312467531247635123456712356471275436124635714263572146357241635724613572463157246371256437212635471326547132564712674352167435261743526714352673145267312735461273456126745312643752125673412657431265374216537426153742651374265713426517342657125476312457631243576124765312746532174653271465327614532761276453217645327164532741653274612543762154376251437625413762543176254371625437512643571246375123657412375641237546126735412763542176354271635427613542763154276351427635'
# # 1634
# string3 = '5127643512456731245763124573612547362154736251473625417362547136254731625473216547326154732651473265417326543127456321745632714563274156327451263745216374526137452631745263712653742165374261537426512734652173465271346527314652734165273461527346251734621573462126453712756341236745126473521647352614735267143526712673452167345261734526713452673145267341526743152674135267412357641235674125463721546372514637254163725461372546317254637125643721564372516437256143725641372564317256437125634721563472516347256134725631472563417256347125364721536472513647253164725361472536417253642175364212475631274536124753612537642124657312467531243576126347521634752613475263147526371452637415263471526341752634123654712356471275436126437521243675124673512634571236574123675412765432176543271654327615432765143276541327645132764153276412375641237465123754612354761235746253174625371462537416253761427356142736514273615427361274356127465321746532714653276145327612534762153476251347625314762534176253471625347612537462153746251374625713462571275463217546327154632751463275361427536126743521674352617435264173526412753642715364273156427312473651274365124765312746351267453123764512765341254367124536721453672415367245136724531672453617245367124356721435672413567243156724351672435617243567124376512536741265473126543712653471256734126574312657342165734261573426517342653174265137426531247635124537612543762154376251437625413762543176254371625437512643571246375124653712735461273564217356427135642751364275123457612635742163574261357426315742635174263571426537142657314265713426571263547132654713256471237654125763412574362157436251743625714362574136257431625734162573146257312645732164573261457326415732645713264517326451267354127635421763542716354276135427635142763154276312534671256473125746312364751236457125674312576431275643217564327156432751643275614327564132754613275416327541273654217365427136542731654273516427351264753123476512347561243756214375624137562431756243715624375162437521643752614375264137526471352647315264371526431752643125736412764532176453271645327416532745163274561327465132746153274612374561234657126375412436572143657241365724316572436157243651724365217436527143652741365274316527436152743651276345125476312753461257346125637412345671235467124563712546731234675124635721463572416357246135724631572463517246312473562147356241735624713562473156247351624753164275316412736451273456126754312675342167534261753426715342675134267531426753'

# team words
string1 = '12357641253746124753621475362417536247153624751362475316247531264753216475326147532641753264715326475132647512475631254736127546312754361235746213574623157462351746235714623574162357412643571264375126453712645731265347126537412356472135647231564723516472356147235641723564126543712654731256473215647325164732561473256417325647132564712354761253467125347612347651243756124357621435762413576243157624351762435716243571257346123754621375462317546237154623751462375416237541237564123765421376542317654237165423761542376514237651247635214763524176352471635247613524763152476312546732154673251467325416732546173254671325467126574321657432615743265174326571432657413265741265734125736421573642517364257136425731642573614257364125763421576342517634257163425761342576314257631257643126753412536742153674251367425316742536174253671425367123675412637451247365124735612453762145376241537624513762453176245371624537126345712634751263547126357412637542163754261375426317542637154263751426375124635712346572134657231465723416572346157234651723465123467512436752143675241367524316752436175243671524367127453612745631274635127465312674351243765214376524137652431765243716524376152437612543671254376124573621457362415736245173624571362457316245731245763125746321574632517463257146325741632574613257461257436123475621347562314756234175623471562347516234751236745213674523167452361745236714523674152367412563741256347123654721365472316547236154723651472365417236541236574125376421537642513764253176425371642537614253761256743125476321547632514763254176325471632547613254761247653126473512467531245367123456721345672314567234156723451672345617234561234576123745621374562317456237145623741562374516237451237465127354612735641273645123647512467352146735241673524617352467135246731524673125463712356741253647123645721364572316457236145723641572364517236451273654127435621743562714356274135627431562743516274351274365124365712465372146537241653724615372465137246531724653127534612753641275634127564312435671235467213546723154672351467235416723546172354612734561273465124637521463752416375246137524631752463715246371267345123764521376452317645237164523761452376415237641256734215673425167342561734256713425673142567312763451276354126735421673542617354267135426731542673514267351276435127645312765341276543126745321674532617453267145326741532674513267451246573125643712456372145637241563724516372456137245631724563124567312675432167543261754326715432675143267541326754'
string2 = '1263475216347526134752631475263417526347152634712573641275346125734621573462517346257134625731462573416257341245637124567312457361245763124653712465731246735124675312764351264735216473526147352641735264713526473152647312657431256743126543712756341265374216537426153742651374265317426537142653712537641273564217356427135642731564273516427356142735612473562147356241735624713562473156247351624735124376512637452163745261374526317452637145263741526374126375412675342167534261753426715342675134267531426753126754312645732164573261457326415732645173264571326457126475312765431276534127365421736542713654273165427361542736514273651275436125746312576341257643125647312764532176453271645327614532764153276451327645124753612475631247635124765312745361254736215473625147362541736254713625473162547312654732165473261547326514732654173265471326547125476312347561234765127346521734652713465273146527341652734615273461276354217635427163542761354276315427635142763512635742163574261357426315742635174263571426357127536421753642715364275136427531642753614275361254673123465712346751234567124356721435672413567243156724351672435617243561274635126734521673452617345267134526731452673415267341256734127546321754632715463275146327541632754613275461265734216573426157342651734265713426573142657312645371256347215634725163472561347256314725634172563412563741273546125743621574362517436257143625741362574316257431234576213457623145762341576234517623457162345712436572143657241365724316572436157243651724365124367512743652174365271436527413652743165274361527436123546712354761235647123567412357461235764123645712364751236547123657412367451236754123745612734562173456271345627314562734156273451627345124736512743561253746215374625137462531746253714625374162537412653471246357214635724163572461357246315724635172463512643571246375126437521643752614375264137526431752643715264371245367214536724153672451367245316724536172453612453761243756214375624137562431756243715624375162437512634571254367125364712536741263547125463721546372514637254163725461372546317254631274563217456327145632741563274516327456132745612374651267354127634512534762153476251347625314762534176253471625347125346712435761254376215437625143762541376254317625437162543712564372156437251643725614372564137256431725643127564321756432715643275164327561432756413275641237645123765412736451267435216743526174352671435267413526743152674312674531274653217465327146532741653274615327465132746512375461237564'
string3 = '1246375127463521746352714635274163527461352746315274631246753214675324167532461753246715324675132467512567432156743251674325617432567143256741325674124365712534672153467251346725314672534167253461725346125347612735462173546271354627315462735146273541627354127356412536472153647251364725316472536147253641725364125734612574361257364123754612753462175346271534627513462753146275341627534127536412356742135674231567423516742356174235671423567123564712643572164357261435726413572643157264351726435125746312637451263754123675421367542316754236175423671542367514236751276435217643527164352761435276413527643152764312576341236547126453721645372614537264153726451372645317264531264573124657321465732416573246157324651732465713246571264375123647521364752316475236147523641752364715236471236457126534721653472615347265134726531472653417265341265743126573412653741237645123476521347652314765234176523471652347615234761253746125376412536741236745126734512634751234675213467523146752341675234617523467152346712346571265437216543726154372651437265413726543172654312654731245763214576324157632451763245716324576132457612563471256374215637425163742561374256317425637142563712756342175634271563427516342756134275631427563124756321475632417563247156324751632475613247561247536127435612743651273645217364527136452731645273614527364152736412736541237654123574612734561264735126475312467351243567124537612453671245637125643712564731254736125476312457361235476213547623154762351476235417623547162354712543761235467126354721635472613547263154726351472635417263541263574123657421365742316574236157423651742365714236571243675124375612745362174536271453627415362745136274531627453127456312374561274653124763512734651276345217634527163452761345276314527634152763412763541276534217653427165342761534276513427653142765312476532147653241765324716532476153247651324765123475612463571247356124736521473652417365247136524731652473615247361276543217654327165432761543276514327654132765412465371254367215436725143672541367254316725436172543612754362175436271543627514362754136275431627543127546312756431256734123756421375642317564237156423751642375614237561243765123746521374652317465237146523741652374615237461276453125764321576432517643257164325761432576413257641235764213576423157642351764235716423576142357612435761254637125467312456732145673241567324516732456173245671324567123457612345671263457216345726134572631457263415726345172634512673541267435126745312675341267543'

# wildcard
string1 = '123756412573461237456213745623174562371456237415623745162374512753641273564127364512736541246573126543712654731256437127634512763541267354216735426173542671354267315426735142673512634571263475126375421637542613754263175426371542637514263751246375214637524163752461375246317524637152463712345672134567231456723415672345167234561723456127463512746531267435123765421376542317654237165423761542376514237651243756123754621375462317546237154623751462375416237541237465123465721346572314657234165723461572346517234651273456123457612457362145736241573624517362457136245731624573124675312457631275436125674312536742153674251367425316742536174253671425367124653721465372416537246153724651372465317246531276435127645312765341276543126753412576431267345123547612753461275463123647512436571236547213654723165472361547236514723654172365412756341275643125476321547632514763254176325471632547613254761235764124736512473561256734215673425167342561734256713425673142567312436752143675241367524316752436175243671524367125436712456372145637241563724516372456137245631724563125746321574632517463257146325741632574613257461235746213574623157462351746235714623574162357412635471263574125763421576342517634257163425761342576314257631257436124356712347651246735214673524167352461735246713524673152467312546732154673251467325416732546173254671325467127346512476352147635241763524716352476135247631524763125473641253764215376425137642531764253716425376142537612475362147536241753624715362475136247531624753126475321647532614753264175326471532647513264751264537126457312643751236754126374512743562174356271435627413562743156274351627435125374612563741256347124756312543761254637127453612745631274365123657432165743261574326517432657143265741*2657431247653124635712453671234675123674521367452316745236174523671452367415236741253647123546721354672315467235146723541672354617235461273546124376521437652413765243176524371652437615243761253467125347612347562134756231475623417562347156234751623475123764521376452317645237164523761452376415237641245376214537624153762451376245317624537162453712674532167453261745326714532674153267451326745124567312564732156473251647325614732564173256471325647231564723516472356147235641*2356472135647212675432167543261754326715432675143267541326754126573412653471265374123567412573642157364251736425713642573164257361425736124357621435762413576243157624351762435716243571264357126473512364572136457231645723614572364157236451723645'
string2 = '126573421657342615734265173426571342657314265731246573126457321645732614573264157326451732645713264576231457623415762345176234571*234576213457621273645126345712364571234657123467512347561234765126734521673452617345267134526731452673415267341256734127534612537462153746251374625317462537146253741625374126375412675342167534261753426715342675134267531426753126754312657431256473126547321654732615473265147326541732654713265471236574123674512367541235647123567412357461235764123456712435672143567241356724315672435167243561724356125743621574362517436257143625741362574316257431275634127643512647352164735261473526417352647135264731526473126453712534671235476123546712364751236547125634721563472516347256134725631472563417256341237456123746512375461237564123764512376541273654217365427136542731654273615427365142736512674352167435261743526714352674135267431526743127456321745632714563274156327451632745613274561273456217345627134562731456273415627345162734512537641273564217356427135642731564273516427356142735612473562147356241735624713562473156247351624735126735412763451263745216374526137452631745263714526374152637412635471254637215463725146372541637254613725463172546312745361243756214375624137562431756243715624375162437512643571243657214365724136572431657243615724365172436512647531275436125746312573641275364217536427153642751364275316427536142753612547362154736251473625417362547136254731625473126745312764532176453271645327614532764153276451327645124367512643752164375261437526413752643175264371526437125436712536471253674125347621534762513476253147625341762534716253471275463217546327154632751463275416327546132754612547631274356127463512476351247365127436521743652714365274136527431652743615274361263574216357426135742631574263517426357142635712463751263475216347526134752631475263417526347152634712576341257643125674312653471265437125643721564372516437256143725641372564317256431275643217564327156432751643275614327564132756412563741265374216537426153742651374265317426537142653712456371245367214536724153672451367245316724536172453612435761254376215437625143762541376254317625437162543712465371246357214635724163572461357246315724635172463542176354271635427613542763154276351*276354212546731246735124675312765431276534127354612453761245673124573612457631247536124756312476531274653217465327146532741653274615327465132746512437651273465217346527134652731465273416527346152734612573462157346251734625713462573146257341625734'
string3 = '1257463127564312347561236547125634712564371254637125467312456732145673241567324516732456173245671324567123456712356471264537216453726145372641537264513726453172645312647351264573124657321465732416573246157324651732465713246571265347216534726153472651347265314726534172653412476351256473125436721543672514367254136725431672543617254361275436217543627154362751436275413627543162754312657341265743126743512674531264375123467521346752314675234167523461752346715234671234657126435721643572614357264135726431572643517264351273564123756421375642317564237156423751642375614237561253476125374612537641253467215346725134672531467253416725346172534612734651274635217463527146352741635274613527463152746312354671237645127645312673451267354126753412675431274563124576321457632415763245176324571632457613245761246537126354721635472613547263154726351472635417263541265374126475312467532146753241675324617532467153246751324675123647521364752316475236147523641752364715236472153647251364725316472536147253641*25364721275634217563427156342751634275613427563142756312746531236745126347512567341263574124673512763452176345271634527613452763145276341527634125367412365742136574231657423615742365174236571423657123645712654372165437261543726514372654137265431726543127546312475632147563241756324715632475163247561324756124736521473652417365247136524731652473615247361254736125674321567432516743256174325671432567413256741276354127653421765342716534276153427651342765413276541273654123765412374561246375127364521736452713645273164527361452736415273641235674213567423156742351674235617423567142356712453761245367124563742156374251637425613742563174256371*2563741263745126375412367542136754231675423617542367154236751423675125743612576341254376127354621735462713546273154627351462735416273541273456127435612475361274365127643521764352716435276143527641352764315276431257643215764325176432571643257614325764132576412357642135764231576423517642357164235761423576124357612345761235476213547623154762351476235417623547162354712634572163457261345726314572634157263451726345123754612753462175346271534627513462753146275341627534127536412573461254763124573612745362174536271453627415362745136274531627453127654321765432716543276154327651432765314276531247653214765324176532471653247615324765132476512374652137465231746523714652374165237461523746126547312573641235746124635712473561243756124365712435671243675124376512347652134765231476523417652347165234761523476'

string1 = '1254736215473625147362541736254713625473162547312376541236745123764512375461265734216573426157342651734265713426573142657312453761245367214536724153672451367245316724536172453612467531276354217635427163542761354276315427635142763512475631247536124375621437562413756243175624371562437516243751234657124563712457361254673125746312754361243576124365721436572413657243165724361572436517243651254367123547612435672143567241356724315672435167243561724356124376512436751234675123546712356471234567123457612534671274653217465327146532741653274615327465132746512374651247365127435612756432175643271564327516432756143275641327564126574312654371246537124567312763451273645127645321764532716453276145327641532764513276451235674125374621537462513746253174625371462537416253741253647215364725136472531647253614725364172536412674531267345216734526173452671345267314526734152673412534762153476251347625314762534176253471625347124763512467351265347127534612357641273546127456321745632714563274156327451632745613274561236475126345712637541263547126357421635742613574263157426351742635714263571246357214635724163572461357246315724635172463512764351274635126473521647352614735264173526471352647315264731265473216547326154732651473265417326547132654712573462157346251734625713462573146257341625734125673412536741264357126347521634752613475263147526341752634715263471256347215634725163472561347256314725634172563412753642175364271536427513642753164275361427536127453612743652174365271436527413652743165274361527436124576312476531267435216743526174352671435267413526743152674312675431267354127365421736542713654273165427361542736514273651263745216374526137452631745263714526374152637412564731257643125674312564372156437251643725614372564137256431725643127546321754632715463275146327541632754613275461235746125376412375641237456123475612347651254376215437625143762541376254317625437162543712364571257364125763412563741265374216537426153742651374265317426537142653712756341236754123657412365471254763125743621574362517436257143625741362574316257431276534126753421675342617534267153426751342675314267531246573126453712463751264753127654321765432716543276154327651432765413276541273564217356427135642731564273516427356142735612473562147356241735624713562473156247351624735126457321645732614573264157326451732645713264571264375216437526143752641375264317526437152643712546372154637251463725416372546137254631725463127346521734652713465273146527341652734615273461273456'
string2 = '1265743216574326157432651743265714326574132657412365741263745123675412637542163754261375426317542637154263751426375124637521463752416375246137524631752463715246371234675126437512645731246537214653724165372461537246513724653172465312745631276453127465312476531246753126745321674532617453267145326741532674513267451275634127654312763541276534127564312576342157634251763425716342576134257631425763123567412375641235764123564721356472315647235164723561472356417235641273654127463512743651273645127643512467352146735241673524617352467135246731524673125467321546732514673254167325461732546713254671234657213465723146572341657234615723465172346512734561237546213754623175462371546237514623754162375412675432167543261754326715432675143267541326754126357412635471256347126547312564732156473251647325614732564173256471325647123475621347562314756234175623471562347516234751267354216735426173542671354267315426735142673512465731246357124735612743561274536124753621475362417536247153624751362475316247531264735126743512673451236745213674523167452361745236714523674152367412536742153674251367425316742536174253671425367124536712534671243567124357621435762413576243157624351762435716243571264537126435712634571243765214376524137652431765243716524376152437612534761253647123546721354672315467235146723541672354617235461273546125374612573461275346127543612574361275463125746321574632517463257146325741632574613257461273564127536412573642157364251736425713642573164257361425736124573621457362415736245173624571362457316245731264753216475326147532641753264715326475132647512634751236475123645721364572316457236145723641572364517236451234765124736521473652417365247136524731652473615247361254736125643712345761235476124365712475631247635214763524176352471635247613524763152476312547632154763251476325417632547163254761325476123574621357462315746235174623571462357416235741256374215637425163742561374256317425637142563712654371265347126537412345672134567231456723415672345167234561723456127346512763451237465123745621374562317456237145623741562374516237451237654123764521376452317645237164523761452376415237641253764215376425137642531764253716425376142537612543761245376214537624153762451376245317624537162453712365472136547231654723615472365147236541723654126753412657341256734215673425167342561734256713425673142567312456372145637241563724516372456137245631724563124576312456731243756124367521436752413675243167524361752436715243671254367125463712567431257643'
string3 = '1267543127564312754631257463125734612574361254763123754612375642137564231756423715642375164237561423756123547621354762315476235147623541762354716235471236457123654712356471236574213657423165742361574236517423657142365712436571236475213647523164752361475236417523647152364712536471235467123465712346752134675231467523416752346175234671523467125367412563741257364125473612543761237465213746523174652371465237416523746152374612736541274563127453621745362714536274153627451362745316274531276534217653427165342761534276513427653142765312674531246735124675321467532416753246175324671532467513246751243675126473512746352174635271463527416352746135274631527463124753612563471263547216354726135472631547263514726354172635412376451273465127436512476351247653214765324176532471653247615324765132476512347561237456123675421367542316754236175423671542367514236751245736124567321456732415673245167324561732456713245671253764125374612357642135764231576423517642357164235761423576124375612743562174356271435627413562743156274351627435127356412756342175634271563427516342756134275631427563124756321475632417563247156324751632475613247561236745123476521347652314765234176523471652347615234761245376124563712546371273645217364527136452731645273614527364152736412543672154367251436725413672543167254361725436127354621735462713546273154627351462735416273541267354127635412376542137654231765423716542376154237651423765124376512473651247356127465312764352176435271643527614352764135276431527643125763412576432157643251764325716432576143257641325764123574612345671246357124536712564371256473125467312645731265473126475312463751264375126347512637451263754126345721634572613457263145726341572634517263451267345127634521763452716345276134527631452763415276341243576125347612534672153467251346725314672534167253461725346127536412753462175346271534627513462753146275341627534125673412567432156743251674325617432567143256741325674123567421356742315674235167423561742356714235671243567124657321465732416573246157324651732465713246571245763214576324157632451763245716324576132457612345762134576231457623415762345176234571623457126534721653472615347265134726531472653417265341276543126743512654372165437261543726514372654137265431726543124653712645372164537261453726415372645137264531726453127345621734562713456273145627341562734516273451267534126573412653741263574126435721643572614357264135726431572643517264351276453127543621754362715436275143627541362754316275431265743'

# wildcard
string1 = '124356721435672413567243156724351672435617243561235467123456712345761243576124537612456731237654127356421735642713564273156427351642735614273561247356214735624173562471356247315624735162473512647352164735261473526417352647135264731526473125364721536472513647253164725361472536417253641274563217456327145632741563274516327456132745612364751263457126375412635742163574261357426315742635174263571426357124637512645371245637124573612543671235476125346712356471235674125367412753642175364271536427513642753164275361427536126574312657342165734261573426517342657134265731426573124657312645732164573261457326415732645173264571326457123645712543762154376251437625413762543176254371625437126745312673452167345261734526713452673145267341526734125473621547362514736254173625471362547316254731265473216547326154732651473265417326547132654712635471264753125764312573641257634125673412563741256437215643725164372561437256413725643172564312756341275436124576312476531267435216743526174352671435267413526743152674312567431276543217654327165432761543276514327654132765412367541236574123654712563472156347251634725613472563147256341725634127653412675342167534261753426715342675134267531426753124675312437651243675123467512357641237564123754612367451237645123746512374561234756123476512476351247563124753612453672145367241536724513672453167245361724536127453612763542176354271635427613542763154276351427635126374521637452613745263174526371452637415263741265374216537426153742651374265317426537142653712436572143657241365724316572436157243651724365271436527413652743165274361*274365217436521265437124653712463572146357241635724613572463157246351724635124673512746351276345127643512764532176453271645327614532764153276451327645127364512734652173465271346527314652734165273461527346251734625713462573146257341*2573462157346212653471254763125746312754632175463271546327514632754163275461327546123574612537641273546127465321746532714653274165327461532746513274651247365127435612756432175643271564327516432756143275641327564126435712634752163475261347526314752634175263471526347125647312534762153476251347625314762534176253471625347123465712643752164375261437526413752643175264371526437125463721546372514637254163725461372546317254631275346127345612437562143756241375624317562437156243751624375125743621574362517436257143625741362574316257431267543126735412736542173654271365427316542736154273651427365125467312537462153746251374625317462537146253741625374'
string2 = '127356412357641235647213564723156472351647235614723564172356412736541274635127453612475362147536241753624715362475136247531624753126475321647532614753264175326471532647513264751264375126734512743651275634126573412765341275643125763421576342517634257163425761342576314257631254763215476325147632541763254716325476132547612354761247635214763524176352471635247613524763152476312457631265743216574326157432651743265714326574132657412563471265347126547312564732156473251647325614732564173256471325647123456721345672314567234156723451672345617234561273465126347512675432167543261754326715432675143267541326754125643712374562137456231745623714562374156237451623745124756312345761237546213754623175462371546237514623754162375412645731246537214653724165372461537246513724653172465312476531246753125367421536742513674253167425361742536714253671245367124356712437561243657124673521467352416735246173524671352467315246731256734215673425167342561734256713425673142567312546732154673251467325416732546173254671325467125346712346751246573127645312746531274563127364572136457231645723614572364157236451*2364571234657213465723146572341657234615723465172346512734561237645213764523176452371645237614523764152376412537642153764251376425317642537164253761425376125463712536471235674123746512763451263745123674521367452316745236174523671452367415236741256374215637425163742561374256317425637142563712437652143765241376524317652437165243761524376125437612457362145736241573624517362457136245731624573126745321674532617453267145326741532674513267451234765123756412753641257364215736425173642571364257316425736142573612453762145376241537624513762453176245371624537126543712653741247356127435612754361257436127546312574632157463251746325714632574163257461325746231574623517462357146235741*235746213574621247365214736524173652471365247316524736152473612547361253476125374612567431243675214367524136752431675243617524367152436712543671235467213546723154672351467235416723546172354612735461257346127534612765431276354127643512674351267534126473512435762143576241357624315762435176243571624357126453712643571236547213654723165472361547236514723654172365412376541267354216735426173542671354267315426735142673512463571236574126357412635471263457125764312456731245637214563724156372451637245613724563172456312347562134756231475623417562347156234751623475123647512367541263754216375426137542631754263715426375142637512463752146375241637524613752463175246371524637'
string3 = '1237645127346512437651275346217534627153462751346275314627534162753412543761254367215436725143672541367254316725436172543612746352174635271463527416352746135274631527463125674321567432516743256174325671432567413256741235674213567423156742351674235617423567142356712573641245367124635712473561237456126743512734562173456271345627314562734156273451627345126734512763452176345271634527613452763145276341527634125763412534761273546217354627135462731546273514627354162735412673541276354125374652137465231746523714652374165237461*237465125637412463751235746123547621354762315476235147623541762354716235471275364127546312674531265473126543721654372615437265143726541372654317265431275643126574312643751247536123675421367542316754236175423671542367514236751243675124736512476532147653241765324716532476153247651324765123475612534672153467251346725314672534167253461725346124675321467532416753246175324671532467513246751236745126754362175436271543627514362754136275431*275436124375612457361276534217653427165342761534276513427653142765312637451263754124576321457632415763245176324571632457613245761243576123457621345762314576234157623451762345716234571267534127364521736452713645273164527361452736415273641265347216534726153472651347265314726534172653412765431265734126537412635741237654213765423176542371654237615423765142376512364571236547123657421365742316574236157423651742365714236571274653127356412456371264537216453726145372641537264513726453172645312764531234765213476523147652341765234716523476152347612643572164357261435726413572643157264351726435127643521764352716435276143527641352764315276431263457216345726134572631457263415726345172634512563471235467124673512546731257463123754612375642137564231756423715642375164237561423756125673412357642135764231576423517642357164235761423576124567321456732415673245167324561732456713245671246573214657324165732461573246517324657132465712436571236475213647523164752361475236417523647152364712536471235647127435621743562714356274135627431562743516274351234567126354721635472613547263154726351472635417263541234657123467521346752314675234167523461752346715234671253764127563421756342715634275163427561342756314275631274563124756321475632417563247156324751632475613247561263475126473512476351257436125367412573461257643215764325176432571643257614325764132576412745362174536271453627415362745136274531627453127436512546371254736124537612647531243567124653712564371256473126457312736541254763'

export_string_map(7, string2, [string1, string3], filename="string2map.txt")
export_string_map(7, string3, [string2, string1], filename="string3map.txt")

# string1 = '123645721364572316457236145723641572364517236451276354127634512673542167354261735426713542673154267351426735127643512674351263547126534712637451236745213674523167452361745236714523674152367412537642153764251376425317642537164253761425376241537624513762453176245371*24537621453762127654312764531274653127463512743651273456123754621375462317546237154623751462375416237541263754216375426137542631754263715426375142637512467352146735241673524617352467135246731524673125463712564371235674125367421536742513674253167425361742536714253671245367124356712476352147635241763524716352476135247631524763125674312576431234765123746512376452137645231764523716452376145237641523764125364712563471265734127653412675341256734215673425167342561734256713425673142567312456731247563124675312476531247356126734512643751236475123675412653741275364125736421573642517364257136425731642573614257361245736214573624157362451736245713624573162457312645371264735126347512437561243765214376524137652431765243716524376152437612543761235476123574621357462315746235174623571462357416235741263574123465721346572314657234165723461572346517234651273645123765412346751246375214637524163752461375246317524637152463712654371265473125647321564732516473256147325641732564713256471253467125347612547361257436127546312745631274356127534612537461257346123457612754361257463215746325174632571463257416325746132574612374562137456231745623714562374156237451623745127563412756431265743216574326157432651743265714326574132657412365741234567213456723145672341567234516723456172345612734651273546127356412736541237564123576412365472136547231654723615472365147236541723654125637421563742516374256137425631742563714256371243657126345712463571264357124563721456372415637245163724561372456317245631234756213475623147562341756234715623475162347512356472135647231564723516472356147235641723564125763421576342517634257163425761342576314257631245763125476321547632514763254176325471632547613254761264573124657312473652147365241736524713652473165247361524736127453612475362147536241753624715362475136247531624753126475321647532614753264175326471532647513264751267543216754326175432671543267514326754132675412465372146537241653724615372465137246531724653124357621435762413576243157624351762435716243571267453216745326174532671453267415326745132674512436752143675241367524316752436175243671524367125436712546732154673251467325416732546173254671325467231546723514672354167235461*23546721354672'


# string1 = string1[:100]
words1 = get_unique_words_in_string(string1)
words2 = get_unique_words_in_string(string2)
words3 = get_unique_words_in_string(string3)

# words1 = []
# words2 = []
# words3 = []
#

# words1 = []
# words2 = []
# words3 = []
# with open('C:/Users/danie/Downloads/2440_2440_2440_perms.csv', newline='') as csvfile:
#     spamreader = csv.reader(csvfile, delimiter=' ', quotechar='|')
#     for row in spamreader:
#         words = row[0].split(',')
#         if words[0] and len(words[0]) > 1:
#             words1 += [words[0]]
#         if words[1] and len(words[1]) > 1:
#             words2 += [words[1]]
#         if words[2] and len(words[2]) > 1:
#             words3 += [words[2]]
#
# print(words3[0], end='')
# for i in range(1,len(words3)):
#     dist = cost(words3[i-1], words3[i])
#     print(words3[i][-dist:], end='')
# exit()

for words in [words1, words2, words3]:
    distances = {
        i: 0 for i in range(8)
    }
    special_distances = {
        i: 0 for i in range(8)
    }

    for i in range(len(words)-1):
        if words[i+1][:2] == '12':
            special_distances[offset(words[i], words[i+1])] += 1
        else:
            distances[offset(words[i], words[i+1])] += 1
    print(distances)
    print(special_distances)
    print()


# strings = improve_with_atsp([string1, string2, string3])
# # strings = improve_with_atsp([words1, words2, words3])
# strings = improve_pairs_with_atsp([string1, string2, string3])
strings = optimize_triple_with_superwords_atsp([string1, string2, string3])
string1 = strings[0]
string2 = strings[1]
string3 = strings[2]

# Improved Wildcard
# string1 = '124635712453671245637214563724156372451637245613724563172456312567342156734251673425617342567134256731425673124367521436752413675243167524361752436715243671245376214537624153762451376245317624537162453712576431235476123576412537642153764251376425317642537164253761425376124573621457362415736245173624571362457316245731247653124567312654371265473125647321564732516473256147325641732564713256472135647231564723516472356147235641*235647212753641274356217435627143562741356274315627435162743512764531276435127634512763541267354216735426173542671354267315426735142673512467352146735241673524617352467135246731524673125463712645371264357126437512436571236547213654723165472361547236514723654172365412756341275643124657312467531245763125476321547632514763254176325471632547613254761236754126374512674532167453261745326714532674153267451326745125743612347562134756231475623417562347156234751623475123657432165743261574326517432657143265741*26574312563741256347124756312745361274563127546312564371246537214653724165372461537246513724653172465312743651234675123476512364751254376125473641257364215736425173642571364257316425736142573612435671234567213456723145672341567234516723456172345612345761253467125347612746351274653126743512376452137645231764523716452376145237641523764126753412576342157634251763425716342576134257631425763123746512367452136745231674523617452367145236741523674125374612573461273546127364512736541273465127345612753461275436124753621475362417536247153624751362475316247531264753216475326147532641753264715326475132647512473651247356123745621374562317456237145623741562374516237451234657213465723146572341657234615723465172346512376542137654231765423716542376154237651423765124375612375462137546231754623715462375146237541623754124376521437652413765243176524371652437615243761267345124763521476352417635247163524761352476315247631257463215746325174632571463257416325746132574612357462135746231574623517462357146235741623574126354712635741265734126534712653741235674125364712354672135467231546723514672354167235461723546124357621435762413576243157624351762435716243571263457126347512637542163754261375426317542637154263751426375124637521463752416375246137524631752463715246371264573126473512536742153674251367425316742536174253671425367125436712567431254673215467325146732541673254617325467132546712375641273564127653412765431267543216754326175432671543267514326754132675412364572136457231645723614572364157236451723645'
# string2 = '12765341235764123456712435672143567241356724315672435167243561724356125467312456371245673124657312453672145367241536724513672453167245361724536126534762153476251347625314762534176253471*2534761253674123564712356741236475123654712365741236745123675412374561273456217345627134562731456273415627346152734612576341257463125736412753642175364271536427513642753164275361427536126475312674531267543126357421635742613574263157426351742635714263571246357214635724163572461357246315724635172463512476351247365127346521734652713465273146527341652734516273451274356127463512674352167435261743526714352674135267431526743126574312765431276453217645327164532761453276415327645132764512673452167345261734526713452673145267341526734125673412563741276345124376512436751234675126347521634752613475263147526341752634715263471256347215634725163472561347256314725634172563412637541267534216753426175342671534267513426753142675312673541276354217635427163542761354276315427635142763512435761235476125437621543762514376254137625431762543716254371254637215463725146372541637254613725463172546312764351253764126453712465371246735124675312745632174563271456327415632745163274561327456123746512375461237564123764512376541273654217365427136542731654273615427365142736512743652174365271436527413652743165274361527436126345762134576231457623415762345176234571*2345761273564217356427135642731564273516427356142735612473562147356241735624713562473156247351624735126473521647352614735264173526471352647315264731264357124365721436572413657243165724361572436517243651254367123546712357461257346215734625173462571346257314625734162573412754361257436215743625174362571436257413625743162574312564731265473216547326154732651473265417326547132654712654371256437215643725164372561437256413725643172564312756341246375127546321754632715463275146327541632754613275461245376124573612457631247536124756312476531274653217465327146532741653274615327465132746512736451263745216374526137452631745263714526374152637412657342165734261573426517342657134265731426573127564321756432715643275164327561432756413275641263547125364712534671273546124375621437562413756243175624371562437516243751264375216437526143752641375264317526437152643712547631274536125473621547362514736254173625471362547316254731264573216457326145732641573264517326457132645712364571234657123475612347651275346125374621537462513746253174625371462537416253741265374216537426153742651374265317426537142653712576431256743'
# string3 = '1276453123674512746352174635271463527416352746135274631527463127356412375461275364123576421357642315764235176423571642357614235761243567124653712645372164537261453726415372645137264531726453124765321476532417653247165324761532476513247651237465213746523174652371465237416523746152374612547631245673214567324156732451673245617324567132456712345761234567123654712635472163547261354726315472635147263541726354127653421765342716534276153427651342765413276541276354123756421375642317564237156423751642375614237561243657124375612437651234765213476523147652341765234716523476152347612453761274365127364521736452713645273164527361452736415273641257364125743612564731254367215436725143672541367254316725436172543612754362175436271543627514362754136275431627543124657321465732416573246157324651732465713246571263457216345726134572631457263415726345172634512673451264573124563742156374251637425613742563174256371*2563741264375123647521364752316475236147523641752364715236472153647251364725316472536147253641*25364721256743215674325167432561743256714325674132567412735462173546271354627315462735146273541627354126735412654731256437123564712356742135674231567423516742356174235671423567126574312647531246735126473512764352176435271643527614352764135276431527643125763412374561274356127453621745362714536274153627451362745316274531267543125463712546731275346217534627153462751346275314627534162753412756342175634271563427516342756134275631427563124573612734651234675213467523146752341675234617523467152346712453671236457124736521473652417365247136524731652473615247361254736123547621354762315476235147623541762354716235471254376127365412376541234756125376412536741257346127456312734561276543217654327165432761543276514327653142765312475361247356123574612534761253746124576321457632415763245176324571632457613245761246753214675324167532461753246715324675132467512574631275643125764321576432517643257164325761432576413257641235467126534721653472615347265134726531472653417265341267534126435721643572614357264135726431572643517264351267453124756321475632417563247156324751632475613247561237645127634521763452716345276134527631452763415276341265734126375412367542136754231675423617542367154236751423675124367512476351246357127465312674351265437216543726154372651437265413726543172654312754631243576125346721534672513467253146725341672534617253461263745126347512463751234657126537412635741236574213657423165742361574236517423657142365712563471256734'

# export_string_map(7, string2, [string1, string3], filename="string2map.txt")
# export_string_map(7, string3, [string2, string1], filename="string3map.txt")
# exit()


# sol5913 = get_5913_sol()
# words5913 = get_unique_words_in_string(sol5913)
# super_words_5193 = get_superwords(words5913)

# strings = solve_atsp([special_words, special_words, special_words], free_words, free_words+special_words, num_strings=3,
#                      UB=2441)
# string1 = strings[0]
# string2 = strings[1]
# string3 = strings[2]
#
# print(words5913)
# print(len(words5913))
# last_i = 0
# for i, w in enumerate(words5913):
#     if w[:2] == '12':
#         print(i - last_i)
#         last_i = i

# string1 = ''
# string2 = ''
# string3 = ''

# while not string3:
# while False:
#     free_words = [w for w in words5913 if w[:2] != '12']
#
#     free_word_groups = [
#         free_words[41*i:41*i+41]
#         for i in range(0, 4920//41)
#     ]
#
#     free_words1 = []
#     free_words2 = []
#     free_words3 = []
#
#     g_ct = 0
#     while g_ct <= 117 // 3:
#         i = int(random.random() * len(free_word_groups))
#         free_words1 += free_word_groups[i]
#         free_word_groups.pop(i)
#         g_ct += 1
#     g_ct = 0
#     while g_ct <= 117 // 3:
#         i = int(random.random() * len(free_word_groups))
#         free_words2 += free_word_groups[i]
#         free_word_groups.pop(i)
#         g_ct += 1
#     g_ct = 0
#     while g_ct <= 117 // 3:
#         i = int(random.random() * len(free_word_groups))
#         free_words3 += free_word_groups[i]
#         free_word_groups.pop(i)
#         g_ct += 1
#
#     sol = solve_atsp([special_words], free_words1, special_words+free_words1, num_strings=1, UB=2441)
#     if sol and len(sol[0] == 2440):
#         string1 = sol[0]
#
#         free_words2 = [w for w in free_words2 if w not in free_words1]
#         sol = solve_atsp([special_words], free_words2, special_words+free_words2, num_strings=1, UB=2441)
#         if sol and len(sol[0] == 2440):
#             string2 = sol[0]
#
#             free_words3 = [w for w in free_words3 if w not in free_words1+free_words2]
#             sol = solve_atsp([special_words], free_words3, special_words+free_words3, num_strings=1, UB=2441)
#             if sol:
#                 string3 = sol[0]



# for words in [words1, words2, words3]:
#     distances = {
#         i: 0 for i in range(8)
#     }
#     special_distances = {
#         i: 0 for i in range(8)
#     }
#
#
#     for i in range(len(words)-1):
#         if words[i+1][:2] == '12':
#             special_distances[offset(words[i], words[i+1])] += 1
#         else:
#             distances[offset(words[i], words[i+1])] += 1
#     print(distances)
#     print(special_distances)
#     print()
# exit()

words1 = get_unique_words_in_string(string1)
words2 = get_unique_words_in_string(string2)
words3 = get_unique_words_in_string(string3)

words1 = [word for word in words1 if word[:2] == '12' or word not in (words2+words3)]
words3 = [word for word in words3 if word[:2] == '12' or word not in (words1+words2)]
words2 = [word for word in words2 if word[:2] == '12' or word not in (words1+words3)]

free_words1 = [w for w in words1 if w not in special_words]
free_words2 = [w for w in words2 if w not in special_words]
free_words3 = [w for w in words3 if w not in special_words]

super_words1 = get_superwords(words1)
super_words2 = get_superwords(words2)
super_words3 = get_superwords(words3)

print(f"String 1: length {len(string1)}, {len(words1)} words, {len(super_words1)} superwords")
print(f"String 2: length {len(string2)}, {len(words2)} words, {len(super_words2)} superwords")
print(f"String 3: length {len(string3)}, {len(words3)} words, {len(super_words3)} superwords")

# print(f"Missing {len(free_words1)-num_words1} words")
# string1 = solve_atsp([special_words], free_words1, special_words+free_words1, num_strings=1, UB=len(string1),
#                      arc_limit=6)[0]

# string2 = solve_atsp([special_words], free_words2, special_words+free_words2, num_strings=1, UB=len(string2))[0]

# string3 = solve_atsp([special_words, special_words], free_words3, special_words+free_words1+free_words3, num_strings=2, UB=len(string3))[0]

# wild_super_words1 = get_wild_super_words(super_words1)

# string1 = string1[:500]
# print(string1)
# special_words = [w for w in special_words if w in string1]
# free_words1 = [w for w in free_words1 if w in string1]

special_wild_words = [w.replace('1', '*') for w in special_words]
special_wild_words += [w.replace('2', '*') for w in special_words]
special_wild_words += [w.replace('3', '*') for w in special_words]
special_wild_words += [w.replace('4', '*') for w in special_words]
special_wild_words += [w.replace('5', '*') for w in special_words]
special_wild_words += [w.replace('6', '*') for w in special_words]
special_wild_words += [w.replace('7', '*') for w in special_words]

# special_wild_words + [w.replace('1', '*') for w in free_words1]
# special_wild_words += [w.replace('2', '*') for w in free_words1]
# special_wild_words += [w.replace('3', '*') for w in free_words1]
# special_wild_words += [w.replace('4', '*') for w in free_words1]
# special_wild_words += [w.replace('5', '*') for w in free_words1]
# special_wild_words += [w.replace('6', '*') for w in free_words1]
# special_wild_words += [w.replace('7', '*') for w in free_words1]

# string1 = solve_atsp([special_words], free_words1, special_wild_words+special_words+free_words1, num_strings=1, UB=len(string1))[0]
# print(string1)
# exit()
# string1 = solve_atsp([special_words], free_words1, wild_super_words1, num_strings=1, UB=len(string1))[0]
# print(string1)

# print("ssdsd", len(string1))
# wild_super_words1 = get_wild_super_words(super_words1)
# string1 = solve_atsp([special_words], free_words1, wild_super_words1, num_strings=1, UB=len(string1))[0]
# print(string1)
#
# wild_super_words2 = get_wild_super_words(super_words2)
# string2 = solve_atsp([special_words], free_words2, special_wild_words+special_words+free_words2, num_strings=1, UB=len(string2))[0]
# print(string2)
# #
# # wild_super_words3 = get_wild_super_words(super_words3)
# string2 = solve_atsp([special_words], free_words3, special_wild_words+special_words+free_words3, num_strings=1, UB=len(string3))[0]
# print(string3)

# strings = solve_atsp([special_words, special_words, special_words],
#                      free_words1+free_words2+free_words3, words,
#                      num_strings=3, UB=2448, arc_limit=4,
#                      save_model=True)
# string1 = strings[0]
# string2 = strings[1]
# string3 = strings[2]

words1 = get_unique_words_in_string(string1)
words2 = get_unique_words_in_string(string2)
words3 = get_unique_words_in_string(string3)

words1 = [word for word in words1 if word[:2] == '12' or word not in (words2+words3)]
words3 = [word for word in words3 if word[:2] == '12' or word not in (words1+words2)]
words2 = [word for word in words2 if word[:2] == '12' or word not in (words1+words3)]

for word in words:
    if word[:2] == '12':
        if not word_is_contained(word, string1):
            print(word)
        assert word_is_contained(word, string1)

        if not word_is_contained(word, string2):
            print(word)
        assert word_is_contained(word, string2)

        if not word_is_contained(word, string3):
            print(word)
        assert word_is_contained(word, string3)
    else:
        if not (word_is_contained(word, string1) or word_is_contained(word, string2)
                or word_is_contained(word, string3)):
            print(word)
        assert (word_is_contained(word, string1) or word_is_contained(word, string2)
                 or word_is_contained(word, string3))

print("Strings ok")
print(len(string1), string1)
print(len(string2), string2)
print(len(string3), string3)

with open("solution7.txt", 'w') as f:
    f.write(f"7 3 {len(words1)} {len(words2)} {len(words3)}\n")
    for word in words1:
        f.write(f"{word}\n")
    for word in words2:
        f.write(f"{word}\n")
    for word in words3:
        f.write(f"{word}\n")

LETTERS = [
    '',  # father christmas
    '',  # mother christmas
    '',  # reindeer
    '',  # elf
    '',  # christmas tree
    '',  # gift
    '',  # ribbon
]
replace_dict = {
 '1': '',
 '2': '',
 '3': '',
 '4': '',
 '5': '',
 '6': '',
 '7': '',
 '*': '',
}

# for i,letter in enumerate(LETTERS):
#     string1 = string1.replace(str(i+1), letter)
#     string2 = string2.replace(str(i+1), letter)
#     string3 = string3.replace(str(i+1), letter)

for k, v in replace_dict.items():
    string1 = string1.replace(k, v)
    string2 = string2.replace(k, v)
    string3 = string3.replace(k, v)

sub = pd.DataFrame()
sub['schedule'] = [string1, string2, string3]
sub.to_csv('submission.csv', index=False)

exit()
improve_submission_with_wildcards()
exit()

replace_dict = {
 '5': '',
 '4': '',
 '8': '',
 '1': '',
 '2': '',
 '3': '',
 '6': '',
 '7': ''}

# words = get_words(7)
#
# get_acvrp_solution(words)

# wildcard_words = set()
# for s in [
#     "123*",
#     "12*4",
#     "1*34",
#     "*234",
#     ]:
#     for p in itertools.permutations(s):
#         wildcard_words.add("".join(p))

# wildcard_words = set()
# for s in [
#     "1234*",
#     "123*5",
#     "12*45",
#     "1*345",
#     "*2345",
#     ]:
#     for p in itertools.permutations(s):
#         wildcard_words.add("".join(p))
#
# words = words + list(wildcard_words)

# for s in [
#     "123456*",
#     "12345*7",
#     "1234*67",
#     "123*567",
#     "12*4567",
#     "1*34567",
#     "*234567",
#     ]:
#     for p in itertools.permutations(s):
#         wildcard_words.add(p)
#
# words = words + list(wildcard_words)
# # solve_atsp(words, save_model=False)
#
# solve_atsp(words, save_model=False, LB=2400, UB=2450)

# get_optimal_solution(get_words(5), num_strings=2, UB=100)
# get_optimal_solution(get_words(7), num_strings=3, LB=2100, UB=2440)

# string1 = maximize_specials(get_words(7), num_strings=1)
#
# print(string1)
#
# string1 = "1234567123465712346751234671253467123546321754362175432617543216754321765471362546213754736215437621543167245316742531674523167453216745312674531627453167243651274365124736512437651243675124365712436517243654612375421637542671354126735421673524163752416357241635274163524716352417635241673521467351246375124635712463517246351274635124763512467351426735146273514672351467325146735216473521674352167345216374521634752163457216345271634521763452167354261375417326145736214573612457361425736145273614572361457623145762134576214357621453762145463172543617254317265461327546327154362715412376451237645471326457132645173264513726453172645371264537216453726145372641537264513276453127645321764532716453276145327641532764513267451326475132*462731541672345167234547213615742361574326157436215743612574316257431265741326574123657412635741265374126573412657431256741325674123567412536741256374125673412567431257643125746312574361527436152473615243761524367152436175243615724361547236154732617453621745361274536172453617425361745236174532617435261743256174326517423651742635174265317426513742651734261573426175342167534217653421756342175364217534621753426173452617342561734265174326751432675413726547261354271635427631542736154273167524316752341675231467532146753124657312465371246531724653127465312476531246753142675314627531467253146752316475321647531264753162475316427531647253164752316541632754127635421763542713654217365241736521473652174365217346521736452173654213675413276541736254673125476312547361254673215476321457632147563214765321476352147632514763215476231543726154372163547263154731625471263547216357421635*7612345761234756132475613427561347256134752613475621347561234754176234517623475162347546271354732165461723456172346517234654612734561273454126375421376452137645417263451276345126734512637451263475126345712634517263412576341254162734516273465127346513274651324765132467153246713524671354621735426317543126754317625471623457162345416732546713254672315463127543612754316271543267154327615432716542637154236715423761542371654613724561374256137452613745621374561237456132745613724651372465467213541623745162374541376254172364517236454136275413267543127654716325462317542361754231675423176452317643521764354276135417632547231654617325476132574613257641325761432576134257613245761325476213542617354267315416372546371254637215436721543716254123674512367454712364571236475123647547312654623712543671254376125347612537461253764125376142537612453761254371265413672541273645127364125736412357641235467123456"
# string2 = "6145732614235761423541672354162735462173546172354617325413267541236754362715463271456327146532714635271463257416325*4271634257163425176342516734251637425163472516342751634*4326175463217546371265473126547231654237165423176542361754263175426173546271354672135467312546713245671324657132467513246157324617532461735246173541623751462375142637514236751423765142736514276351427653142765134276514327651423756142375421637542137654327165432671546137254316725431267541263715426137541276354172635417362547316254732615472631547261354136275427136543217654321675421763543621734562173454367213456721346572136457213654721365742136572413657214365413726543172654361275463721542173654712365471326547136254371625347162537416253714625371642537162453716254376215421367541237654231675427316543276154276315427613541327654312765436172356417235614732561473526147356214735612473561427356147235617423561724356172546317254612735416372541367251436725134672541376254317625341726534712653472156347215364721534672153476215347216534726153472651437265147326514723651472635147265314726513472653417256341725364172534617253416725341762531476253174625317642531762453176254367126354712635431627546312754612371546237154126735462137542736154176325471632547236147523614753261475362147536124753614275361472536147623514762354176235471623547216354236715426371542167315462731546723154671235412736541723654173265437126543721654372615473621547361254732165243716524317652431567243156274351624735162437516243571642351764235167423516472351642735164237516423571643251764325167432516473251643725614372564137256431725643712564731256471325647123564712536471256347125643721564372516432756143275641327564312756432175643271564327516432571643527164357216435712643517264351276435126743512647351264375126435716243517624351672435162743561274356217435627143567214356712435671423567143256714352671435627413562471356241735624137562413576241356724135627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243154762315476321745632174653217463521746315247631524673152463715246317524631572463152746315742631574623517462357146235741623574612357462135746231574632157463251746325714632751463271546732154267315426713547621354761235476132541673254163274516324751632457163245176324516732451637245163274543761243576124375612437547631254613275423761****"
# string3 = "7214365721346752134672513647251367425136724513672547216354761325436172542637145263714256371425423176543216754213675423716452371645432617543271654273615476213547263145726314752631472563147254371625471326547231657423165724316572341657231465723164572316547236154732615436271453627145467231456723145473621546731245673124543267145326714543762154637214563721465372146357214637521436752143765214375621437526143752164375214637251463721546371245637124543127654632713456271345471263754126375432761543726154217365412736541327654132674153267413526471352641735264137524613752413675241376524137526413572614357261345726135742613572461357264157326415723641527364152376415236741523647152364175236415726341527634152673415263741526347152634175263415726431527643152674315264731526437152643175264315726413527641352674136257413624571362451736245*631274563127454763215467132547136254716327541632754613275463217547631245763124756312476153247615471236754123675421763541276354136725416372541673254176325417263547312645731264543217654213765423671452367142536714275631427564123756412735641275346127534162753412675341276534127563412753641275431672546137254617324561732465173246153724615327461532647153264175326417325641732546172354276135247613527461352761435276134527613542763145276314547612376541237654216735412673541627354167235436712453671245431726541372654173265417236542713652471365274136527143652713465271364527136542376145237614546712354216375426137542631745263174256317425476231546732156473215674321567342156732415637241563274156324715632417563241576324156732145673215462173546271354623175437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316241537624153672415362741536247153624175362415736241543621754236175436127354612735463172456317245437126547162375416237546123754621375462371456237146523741652374615234765123476521347652314765234176523471652347615234671523461752346157234615273461523746512374652137465231746523714654672135462731456273145267314521367452136475213642571364251736425*312675431627543176254137625143627513462751364275136247513627451362754136275143625714362517436251473625143762513476251374625137642513762451376254173625417623547261354721365427316524731652743165273416527314652731645273165427163542617354267134526713425671342657143265714236571426357142653714265731425673142576314257316425731462573416257346125734621573462517346257134625731426571342675134267153427615342716534271563427153642715346271534267135426731547361254231675437612543672145367214***"
#

# print(len(string1))
# print(string1)


# get_optimal_solution(get_words(7), UB=2430, LB=2430)

# split_and_search(7)

# local_search(7)

# words = get_words(7)

# words = [w for w in words if int(w[0]) != 5 and int(w[1]) != 4]

# get_word_clusters(words[:1000])

# # partition_and_solve(num_letters=7,
# #                     num_partitions=200,
# #                     partition_idx=0,
#                     num_wildcards=2,
#                     disperse_specials=True)

# words = get_words(7)
# special_words = [w for w in words if w[:2] == '54']
# # other_words = [w for w in words if w[:2] != '54']
#
# string1 = maximize_specials(words, num_strings=1)
# print(string1)
# other54_words = [w for w in words if ('54' in w) and w not in special_words]
# words_45 = [w for w in words if '45' in w]
#
# print(f"words: {len(words)}")
# print(f"special_words: {len(special_words)}")
# print(f"other54_words: {len(other54_words)}")
# print(f"words_45: {len(words_45)}")
#
# words54 = {}
# words54[0] = [w for w in words
#               if (w[0] == '5' and w[2] == '4')
#               or (w[0] == '5' and w[3] == '4')
#               or (w[0] == '5' and w[4] == '4')
#               or (w[0] == '5' and w[5] == '4')
#               or (w[0] == '5' and w[6] == '4')]
#
# words54[1] = [w for w in words
#               if (w[1] == '5' and w[3] == '4')
#               or (w[1] == '5' and w[4] == '4')
#               or (w[1] == '5' and w[5] == '4')
#               or (w[1] == '5' and w[6] == '4')]
#
# words54[2] = [w for w in words
#               if (w[2] == '5' and w[4] == '4')
#               or (w[2] == '5' and w[5] == '4')
#               or (w[2] == '5' and w[6] == '4')]
#
# words54[3] = [w for w in words
#               if (w[3] == '5' and w[5] == '4')
#               or (w[3] == '5' and w[6] == '4')]
#
# words54[4] = [w for w in words
#               if (w[4] == '5' and w[6] == '4')]
#
# words45 = {}
# words45[0] = [w for w in words
#               if (w[0] == '4' and w[2] == '5')
#               or (w[0] == '4' and w[3] == '5')
#               or (w[0] == '4' and w[4] == '5')
#               or (w[0] == '4' and w[5] == '5')
#               or (w[0] == '4' and w[6] == '5')]
#
# words45[1] = [w for w in words
#               if (w[1] == '4' and w[3] == '5')
#               or (w[1] == '4' and w[4] == '5')
#               or (w[1] == '4' and w[5] == '5')
#               or (w[1] == '4' and w[6] == '5')]
#
# words45[2] = [w for w in words
#               if (w[2] == '4' and w[4] == '5')
#               or (w[2] == '4' and w[5] == '5')
#               or (w[2] == '4' and w[6] == '5')]
#
# words45[3] = [w for w in words
#               if (w[3] == '4' and w[5] == '5')
#               or (w[3] == '4' and w[6] == '5')]
#
# words45[4] = [w for w in words
#               if (w[4] == '4' and w[6] == '5')]
#
# total_words = len(special_words)
# total_words += len(other54_words)
# total_words += len(words_45)
# for i in range(5):
#     print(len(words54[i]))
#     print(len(words45[i]))
#     total_words += len(words54[i])
#     total_words += len(words45[i])
# print()
# print(total_words)
# print()
#
# groups = [[], [], []]
#
# groups[0] += special_words
# groups[1] += special_words
# groups[2] += special_words
#
# groups[0] += other54_words[:200]
# groups[1] += other54_words[200:400]
# groups[2] += other54_words[400:]
#
# for i in range(3):
#     print(len(groups[i]))
# print()
#
# groups[0] += words_45[:240]
# groups[1] += words_45[240:480]
# groups[2] += words_45[480:]
#
# for i in range(3):
#     print(len(groups[i]))
# print()
#
# for i in range(5):
#     s = len(words54[i]) // 3
#     print(s, len(words54[i]))
#     print(len(words54[i][:s]))
#     print(len(words54[i][s:2 * s]))
#     print(len(words54[i][2 * s:]))
#
#     groups[0] += words54[i][:s]
#     groups[1] += words54[i][s:2 * s]
#     groups[2] += words54[i][2 * s:]
#
#     s = len(words45[i]) // 3
#     print(s, len(words45[i]))
#     print(len(words45[i][:s]))
#     print(len(words45[i][s:2 * s]))
#     print(len(words45[i][2 * s:]))
#     groups[0] += words45[i][:s]
#     groups[1] += words45[i][s:2 * s]
#     groups[2] += words45[i][2 * s:]
#     for i in range(3):
#         print(len(groups[i]))
#
# for i in range(3):
#     print(len(groups[i]))
#
# for g in groups:
#     string1 = get_optimal_solution(g, num_strings=1, num_wildcards=2)
#     print(len(string1), string1)



# cost 2509
# string1 = '12345671234657123467512346712534671235463217543621754326175432167543217654713625462137547362154376215431672453167425316745231674532167453126745316274531672436512743651247365124376512436751243657124365172436546123754216375426713541267354216735241637524163572416352741635247163524176352416735214673512463751246357124635172463512746351247635124673514267351462735146723514673251467352164735216743521673452163745216347521634572163452716345217634521673542613754173261457362145736124573614257361452736145723614576231457621345762143576214537621454631725436172543172654613275463271543627154123764512376454713264571326451732645137264531726453712645372164537261453726415372645132764531276453217645327164532761453276415327645132674513264751326454627315416723451672345472136157423615743261574362157436125743162574312657413265741236574126357412653741265734126574312567413256741235674125367412563741256734125674312576431257463125743615274361524736152437615243671524361752436157243615472361547326174536217453612745361724536174253617452361745326174352617432561743265174236517426351742653174265137426517342615734261753421675342176534217563421753642175346217534261734526173425617342651743267514326754137265472613542716354276315427361542731675243167523416752314675321467531246573124653712465317246531274653124765312467531426753146275314672531467523164753216475312647531624753164275316472531647523165416327541276354217635427136542173652417365214736521743652173465217364521736542136754132765417362546731254763125473612546732154763214576321475632147653214763521476325147632154762315437261543721635472631547316254712635472163574216357547612345761234756132475613427561347256134752613475621347561234754176234517623475162347546271354732165461723456172346517234654612734561273454126375421376452137645417263451276345126734512637451263475126345712634517263412576341254162734516273465127346513274651324765132467153246713524671354621735426317543126754317625471623457162345416732546713254672315463127543612754316271543267154327615432716542637154236715423761542371654613724561374256137452613745621374561237456132745613724651372465467213541623745162374541376254172364517236454136275413267543127654716325462317542361754231675423176452317643521764354276135417632547231654617325476132574613257641325761432576134257613245761325476213542617354267315416372546371254637215436721543716254123674512367454712364571236475123647547312654623712543671254376125347612537461253764125376142537612453761254371265413672541273645127364125736412357641235467123456'
# string3 = '7214365721346752134672513647251367425136724513672547216354761325436172542637145263714256371425423176543216754213675423716452371645432617543271654273615476213547263145726314752631472563147254371625471326547231657423165724316572341657231465723164572316547236154732615436271453627145467231456723145473621546731245673124543267145326714543762154637214563721465372146357214637521436752143765214375621437526143752164375214637251463721546371245637124543127654632713456271345471263754126375432761543726154217365412736541327654132674153267413526471352641735264137524613752413675241376524137526413572614357261345726135742613572461357264157326415723641527364152376415236741523647152364175236415726341527634152673415263741526347152634175263415726431527643152674315264731526437152643175264315726413527641352674136257413624571362451736245154631274563127454763215467132547136254716327541632754613275463217547631245763124756312476153247615471236754123675421763541276354136725416372541673254176325417263547312645731264543217654213765423671452367142536714275631427564123756412735641275346127534162753412675341276534127563412753641275431672546137254617324561732465173246153724615327461532647153264175326417325641732546172354276135247613527461352761435276134527613542763145276314547612376541237654216735412673541627354167235436712453671245431726541372654173265417236542713652471365274136527143652713465271364527136542376145237614546712354216375426137542631745263174256317425476231546732156473215674321567342156732415637241563274156324715632417563241576324156732145673215462173546271354623175437216547321657432165734216573241653724165327416532471653241765324167532416573214657321645732165473162457316241537624153672415362741536247153624175362415736241543621754236175436127354612735463172456317245437126547162375416237546123754621375462371456237146523741652374615234765123476521347652314765234176523471652347615234671523461752346157234615273461523746512374652137465231746523714654672135462731456273145267314521367452136475213642571364251736425154312675431627543176254137625143627513462751364275136247513627451362754136275143625714362517436251473625143762513476251374625137642513762451376254173625417623547261354721365427316524731652743165273416527314652731645273165427163542617354267134526713425671342657143265714236571426357142653714265731425673142576314257316425731462573416257346125734621573462517346257134625731426571342675134267153427615342716534271563427153642715346271534267135426731547361254231675437612543672145367214'
# string2 = '61457326142357614235416723541627354621735461723546173254132675412367543627154632714563271465327146352714632574163257454271634257163425176342516734251637425163472516342751634254326175463217546371265473126547231654237165423176542361754263175426173546271354672135467312546713245671324657132467513246157324617532461735246173541623751462375142637514236751423765142736514276351427653142765134276514327651423756142375421637542137654327165432671546137254316725431267541263715426137541276354172635417362547316254732615472631547261354136275427136543217654321675421763543621734562173454367213456721346572136457213654721365742136572413657214365413726543172654361275463721542173654712365471326547136254371625347162537416253714625371642537162453716254376215421367541237654231675427316543276154276315427613541327654312765436172356417235614732561473526147356214735612473561427356147235617423561724356172546317254612735416372541367251436725134672541376254317625341726534712653472156347215364721534672153476215347216534726153472651437265147326514723651472635147265314726513472653417256341725364172534617253416725341762531476253174625317642531762453176254367126354712635431627546312754612371546237154126735462137542736154176325471632547236147523614753261475362147536124753614275361472536147623514762354176235471623547216354236715426371542167315462731546723154671235412736541723654173265437126543721654372615473621547361254732165243716524317652431567243156274351624735162437516243571642351764235167423516472351642735164237516423571643251764325167432516473251643725614372564137256431725643712564731256471325647123564712536471256347125643721564372516432756143275641327564312756432175643271564327516432571643527164357216435712643517264351276435126743512647351264375126435716243517624351672435162743561274356217435627143567214356712435671423567143256714352671435627413562471356241735624137562413576241356724135627431562473156243715624317562341576234156723415627341562374156234715623417562314756231745623175462317564231576421356742135647213564271356421735642137564213576421537462153742615374216537421563742153674215376421573642157634215764321576423156742315647231564273156423715642317562431576243154762315476321745632174653217463521746315247631524673152463715246317524631572463152746315742631574623517462357146235741623574612357462135746231574632157463251746325714632751463271546732154267315426713547621354761235476132541673254163274516324751632457163245176324516732451637245163274543761243576124375612437547631254613275423761'
